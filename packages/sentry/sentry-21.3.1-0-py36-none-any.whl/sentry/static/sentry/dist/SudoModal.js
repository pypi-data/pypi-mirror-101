(self.webpackChunk=self.webpackChunk||[]).push([["SudoModal"],{"./app/components/modals/sudoModal.tsx":(e,t,n)=>{"use strict";n.r(t),n.d(t,{SudoModal:()=>U,default:()=>E});var r=n("../../../../node_modules/@babel/runtime/regenerator/index.js"),s=n.n(r),o=n("../../../../node_modules/@babel/runtime/helpers/asyncToGenerator.js"),a=n.n(o),u=n("../../../../node_modules/@babel/runtime/helpers/classCallCheck.js"),l=n.n(u),c=n("../../../../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(c),p=n("../../../../node_modules/@babel/runtime/helpers/inherits.js"),d=n.n(p),h=n("../../../../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(h),m=n("../../../../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),y=n.n(m),b=n("../../../../node_modules/@emotion/styled-base/dist/styled-base.browser.esm.js"),v=n("../../../../node_modules/react/index.js"),g=n("../../../../node_modules/react-router/es/index.js"),x=n("./app/components/alert.tsx"),Z=n("./app/components/button.tsx"),w=n("../../../../node_modules/@babel/runtime/helpers/extends.js"),S=n.n(w),k=n("./app/utils/withApi.tsx"),C=n("./app/components/u2f/u2fsign.tsx"),R=n("../../../../node_modules/@emotion/core/dist/core.browser.esm.js");var P=function(e){d()(u,e);var t,n,r,o=(n=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=y()(n);if(r){var s=y()(this).constructor;e=Reflect.construct(t,arguments,s)}else e=t.apply(this,arguments);return f()(this,e)});function u(){var e;l()(this,u);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.call.apply(o,[this].concat(n))).state={authenticators:[]},e}return i()(u,[{key:"componentDidMount",value:function(){this.getAuthenticators()}},{key:"getAuthenticators",value:(t=a()(s().mark((function e(){var t,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.api,e.prev=1,e.next=4,t.requestPromise("/authenticators/");case 4:n=e.sent,this.setState({authenticators:null!=n?n:[]}),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(1);case 10:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.props.className,n=this.state.authenticators;return n.length?(0,R.tZ)("div",{className:t},n.map((function(t){return"u2f"===t.id&&t.challenge?(0,R.tZ)(C.Z,S()({key:t.id},e.props,{challengeData:t.challenge})):null}))):null}}]),u}(v.Component);P.displayName="U2fContainer";const j=(0,k.Z)(P);var _=n("./app/icons/index.tsx"),B=n("./app/locale.tsx"),M=n("./app/stores/configStore.tsx"),q=n("./app/styles/space.tsx"),A=n("./app/views/settings/components/forms/form.tsx"),F=n("./app/views/settings/components/forms/inputField.tsx"),T=n("./app/views/settings/components/text/textBlock.tsx");var U=function(e){d()(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=y()(t);if(n){var s=y()(this).constructor;e=Reflect.construct(r,arguments,s)}else e=r.apply(this,arguments);return f()(this,e)});function o(){var e;l()(this,o);for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return(e=r.call.apply(r,[this].concat(n))).state={error:!1,busy:!1},e.handleSuccess=function(){var t=e.props,n=t.closeModal,r=t.superuser,s=t.location,o=t.router,a=t.retryRequest;a?r?o.replace({pathname:s.pathname,state:{forceUpdate:new Date}}):e.setState({busy:!0},(function(){a().then((function(){e.setState({busy:!1},n)}))})):n()},e.handleError=function(){e.setState({busy:!1,error:!0})},e.handleU2fTap=function(){var t=a()(s().mark((function t(n){var r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({busy:!0}),r=e.props.api,t.prev=2,t.next=5,r.requestPromise("/auth/",{method:"PUT",data:n});case 5:e.handleSuccess(),t.next=12;break;case 8:throw t.prev=8,t.t0=t.catch(2),e.setState({busy:!1}),t.t0;case 12:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(e){return t.apply(this,arguments)}}(),e}return i()(o,[{key:"renderBodyContent",value:function(){var e=this.props.superuser,t=this.state.error,n=M.Z.get("user");return n.hasPasswordAuth?(0,R.tZ)(v.Fragment,null,(0,R.tZ)(N,null,e?(0,B.t)("You are attempting to access a resource that requires superuser access, please re-authenticate as a superuser."):(0,B.t)("Help us keep your account safe by confirming your identity.")),t&&(0,R.tZ)(D,{type:"error",icon:(0,R.tZ)(_.Gy,{size:"md"})},(0,B.t)("Incorrect password")),(0,R.tZ)(A.Z,{apiMethod:"PUT",apiEndpoint:"/auth/",submitLabel:(0,B.t)("Confirm Password"),onSubmitSuccess:this.handleSuccess,onSubmitError:this.handleError,hideFooter:!n.hasPasswordAuth,resetOnError:!0},(0,R.tZ)(O,{type:"password",inline:!1,label:(0,B.t)("Password"),name:"password",autoFocus:!0,flexibleControlStateSize:!0}),(0,R.tZ)(j,{displayMode:"sudo",onTap:this.handleU2fTap}))):(0,R.tZ)(v.Fragment,null,(0,R.tZ)(T.Z,null,(0,B.t)("You will need to reauthenticate to continue.")),(0,R.tZ)(Z.ZP,{priority:"primary",href:"/auth/login/?next=".concat(encodeURIComponent(location.pathname))},(0,B.t)("Continue")))}},{key:"render",value:function(){var e=this.props,t=e.closeModal,n=e.Header,r=e.Body;return(0,R.tZ)(v.Fragment,null,(0,R.tZ)(n,{closeButton:!0,onHide:t},(0,B.t)("Confirm Password to Continue")),(0,R.tZ)(r,null,this.renderBodyContent()))}}]),o}(v.Component);U.displayName="SudoModal";const E=(0,g.withRouter)((0,k.Z)(U));var N=(0,b.Z)(T.Z,{target:"eag9q640",label:"StyledTextBlock"})("margin-bottom:",(0,q.Z)(1),";"),O=(0,b.Z)(F.Z,{target:"eag9q641",label:"StyledInputField"})({name:"131yq1t",styles:"padding-left:0;"}),D=(0,b.Z)(x.Z,{target:"eag9q642",label:"StyledAlert"})({name:"gx0lhm",styles:"margin-bottom:0;"})}}]);
//# sourceMappingURL=SudoModal.js.map