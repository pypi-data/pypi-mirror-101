(self.webpackChunk=self.webpackChunk||[]).push([["app_components_avatarChooser_tsx-app_views_settings_components_settingsPageHeader_tsx"],{"./app/components/avatarChooser.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>Q});var r=n("../../../../node_modules/@babel/runtime/helpers/extends.js"),a=n.n(r),o=n("../../../../node_modules/@babel/runtime/helpers/defineProperty.js"),i=n.n(o),s=n("../../../../node_modules/@babel/runtime/helpers/classCallCheck.js"),l=n.n(s),u=n("../../../../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(u),p=n("../../../../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=n.n(p),f=n("../../../../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(f),g=n("../../../../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),v=n.n(g),h=n("../../../../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),b=n.n(h),y=n("../../../../node_modules/@emotion/styled-base/dist/styled-base.browser.esm.js"),Z=n("../../../../node_modules/react/index.js"),S=n("./app/actionCreators/indicator.tsx"),x=n("./app/components/avatar/index.tsx");const D=(0,y.Z)("div",{target:"ed8v6mn0",label:"Well"})("border:1px solid ",(function(e){return e.theme.border}),";box-shadow:none;background:",(function(e){return e.theme.backgroundSecondary}),";padding:",(function(e){return e.hasImage?"80px 30px":"15px 20px"}),";margin-bottom:20px;border-radius:3px;",(function(e){return e.centered&&"text-align: center"}),";");var w=n("./app/constants/index.tsx"),z=n("./app/locale.tsx"),j=n("../../../../node_modules/@emotion/core/dist/core.browser.esm.js");function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I={nw:["top","left"],ne:["top","right"],se:["bottom","right"],sw:["bottom","left"]},k=function(e){m()(a,e);var t,n,r=(t=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=b()(t);if(n){var a=b()(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return v()(this,e)});function a(){var e;l()(this,a);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.call.apply(r,[this].concat(n))).state={file:null,objectURL:null,mousePosition:{pageX:0,pageY:0},resizeDimensions:{top:0,left:0,size:0},resizeDirection:null},e.file=Z.createRef(),e.canvas=Z.createRef(),e.image=Z.createRef(),e.cropContainer=Z.createRef(),e.MIN_DIMENSION=256,e.MAX_DIMENSION=1024,e.ALLOWED_MIMETYPES="image/gif,image/jpeg,image/png",e.onSelectFile=function(t){var n=t.target.files&&t.target.files[0];if(n)if(/^image\//.test(n.type)){e.revokeObjectUrl();var r=e.props.updateDataUrlState,a=window.URL.createObjectURL(n);e.setState({file:n,objectURL:a},(function(){return r({savedDataUrl:null})}))}else(0,S.Iw)((0,z.t)("That is not a supported file type."))},e.revokeObjectUrl=function(){return e.state.objectURL&&window.URL.revokeObjectURL(e.state.objectURL)},e.onImageLoad=function(){var t=e.validateImage();if(t)return e.revokeObjectUrl(),e.setState({objectURL:null}),void(0,S.Iw)(t);var n=e.image.current;if(n){var r={resizeDimensions:{size:Math.min(n.clientHeight,n.clientWidth),top:0,left:0}};e.setState(r,e.drawToCanvas)}},e.updateDimensions=function(t){var n=e.cropContainer.current;if(n){var r=e.state,a=r.mousePosition,o=r.resizeDimensions,i=t.pageY,s=t.pageX,l=o.top+(i-a.pageY),u=o.left+(s-a.pageX);l<0?(l=0,i=a.pageY):l+o.size>n.clientHeight&&(l=n.clientHeight-o.size,i=a.pageY),u<0?(u=0,s=a.pageX):u+o.size>n.clientWidth&&(u=n.clientWidth-o.size,s=a.pageX),e.setState((function(e){return{resizeDimensions:_(_({},e.resizeDimensions),{},{top:l,left:u}),mousePosition:{pageX:s,pageY:i}}}))}},e.onMouseDown=function(t){t.preventDefault(),e.setState({mousePosition:{pageY:t.pageY,pageX:t.pageX}}),document.addEventListener("mousemove",e.updateDimensions),document.addEventListener("mouseup",e.onMouseUp)},e.onMouseUp=function(t){t.preventDefault(),document.removeEventListener("mousemove",e.updateDimensions),document.removeEventListener("mouseup",e.onMouseUp),e.drawToCanvas()},e.startResize=function(t,n){n.stopPropagation(),n.preventDefault(),document.addEventListener("mousemove",e.updateSize),document.addEventListener("mouseup",e.stopResize),e.setState({resizeDirection:t,mousePosition:{pageY:n.pageY,pageX:n.pageX}})},e.stopResize=function(t){t.stopPropagation(),t.preventDefault(),document.removeEventListener("mousemove",e.updateSize),document.removeEventListener("mouseup",e.stopResize),e.setState({resizeDirection:null}),e.drawToCanvas()},e.updateSize=function(t){var n=e.cropContainer.current;if(n){var r=e.state.mousePosition,a=t.pageY-r.pageY,o=t.pageX-r.pageX;e.setState({resizeDimensions:e.getNewDimensions(n,a,o),mousePosition:{pageX:t.pageX,pageY:t.pageY}})}},e.getDiffNW=function(e,t){return(e-2*e+(t-2*t))/2},e.getDiffNE=function(e,t){return(e-2*e+t)/2},e.getDiffSW=function(e,t){return(e+(t-2*t))/2},e.getDiffSE=function(e,t){return(e+t)/2},e.getNewDimensions=function(t,n,r){var a=e.state,o=a.resizeDimensions,i=a.resizeDirection,s=e["getDiff"+i.toUpperCase()](n,r),l=t.clientHeight-o.top,u=t.clientWidth-o.left,c="nw"===i||"ne"===i,p="nw"===i||"sw"===i,d={top:0,left:0,size:o.size+s};c&&(d.top=o.top-s,l=t.clientHeight-d.top),p&&(d.left=o.left-s,u=t.clientWidth-d.left),d.top<0&&(d.size=d.size+d.top,p&&(d.left=d.left-d.top),d.top=0),d.left<0&&(d.size=d.size+d.left,c&&(d.top=d.top-d.left),d.left=0);var f=Math.min(u,l);return d.size>f?(c&&(d.top=d.top+d.size-f),p&&(d.left=d.left+d.size-f),d.size=f):d.size<e.MIN_DIMENSION&&(c&&(d.top=d.top+d.size-e.MIN_DIMENSION),p&&(d.left=d.left+d.size-e.MIN_DIMENSION),d.size=e.MIN_DIMENSION),_(_({},o),d)},e.uploadClick=function(t){t.preventDefault(),e.file.current&&e.file.current.click()},e}return c()(a,[{key:"componentWillUnmount",value:function(){this.revokeObjectUrl()}},{key:"validateImage",value:function(){var e=this.image.current;return e?e.naturalWidth<this.MIN_DIMENSION||e.naturalHeight<this.MIN_DIMENSION?(0,z._N)("Please upload an image larger than [size]px by [size]px.",{size:this.MIN_DIMENSION-1}):e.naturalWidth>this.MAX_DIMENSION||e.naturalHeight>this.MAX_DIMENSION?(0,z._N)("Please upload an image smaller than [size]px by [size]px.",{size:this.MAX_DIMENSION}):null:null}},{key:"drawToCanvas",value:function(){var e=this.canvas.current;if(e){var t=this.image.current;if(t){var n=this.state.resizeDimensions,r=n.left,a=n.top,o=n.size,i=(t.naturalHeight/t.clientHeight+t.naturalWidth/t.clientWidth)/2;e.width=o*i,e.height=o*i,e.getContext("2d").drawImage(t,r*i,a*i,o*i,o*i,0,0,o*i,o*i),this.props.updateDataUrlState({dataUrl:e.toDataURL()})}}}},{key:"imageSrc",get:function(){var e,t=this.props,n=t.savedDataUrl,r=t.model,a=t.type,o=null===(e=r.avatar)||void 0===e?void 0:e.avatarUuid,i=o&&"/".concat(w.f6[a]||"avatar","/").concat(o,"/");return n||this.state.objectURL||i}},{key:"renderImageCrop",value:function(){var e=this,t=this.imageSrc;if(!t)return null;var n=this.state,r=n.resizeDimensions,a=n.resizeDirection,o={top:r.top,left:r.left,width:r.size,height:r.size};return(0,j.tZ)(C,{resizeDirection:a},(0,j.tZ)(P,{ref:this.cropContainer},(0,j.tZ)("img",{ref:this.image,src:t,onLoad:this.onImageLoad,onDragStart:function(e){return e.preventDefault()}}),(0,j.tZ)(R,{style:o,onMouseDown:this.onMouseDown},Object.keys(I).map((function(t){return(0,j.tZ)(E,{key:t,position:t,onMouseDown:e.startResize.bind(e,t)})})))))}},{key:"render",value:function(){var e=this.imageSrc,t=(0,j.tZ)("a",{onClick:this.uploadClick}),n=(0,j.tZ)(D,{hasImage:!0,centered:!0},(0,j.tZ)("p",null,(0,z._N)("[upload:Upload a photo] to get started.",{upload:t})));return(0,j.tZ)(Z.Fragment,null,!e&&n,e&&(0,j.tZ)(M,{ref:this.canvas}),this.renderImageCrop(),(0,j.tZ)("div",{className:"form-group"},e&&(0,j.tZ)("a",{onClick:this.uploadClick},(0,z.t)("Change Photo")),(0,j.tZ)(U,{ref:this.file,type:"file",accept:this.ALLOWED_MIMETYPES,onChange:this.onSelectFile})))}}]),a}(Z.Component);k.displayName="AvatarCropper";const N=k;var U=(0,y.Z)("input",{target:"e1eh795y0",label:"UploadInput"})({name:"10bu0qy",styles:"position:absolute;opacity:0;"}),C=(0,y.Z)("div",{target:"e1eh795y1",label:"ImageCropper"})("cursor:",(function(e){return e.resizeDirection?"".concat(e.resizeDirection,"-resize"):"default"}),";text-align:center;margin-bottom:20px;background-size:20px 20px;background-position:0 0,0 10px,10px -10px,-10px 0px;background-color:",(function(e){return e.theme.background}),";background-image:linear-gradient( 45deg,",(function(e){return e.theme.backgroundSecondary})," 25%,rgba(0,0,0,0) 25% ),linear-gradient(-45deg,",(function(e){return e.theme.backgroundSecondary})," 25%,rgba(0,0,0,0) 25%),linear-gradient(45deg,rgba(0,0,0,0) 75%,",(function(e){return e.theme.backgroundSecondary})," 75%),linear-gradient(-45deg,rgba(0,0,0,0) 75%,",(function(e){return e.theme.backgroundSecondary})," 75%);"),P=(0,y.Z)("div",{target:"e1eh795y2",label:"CropContainer"})({name:"8gjx6o",styles:"display:inline-block;position:relative;max-width:100%;"}),R=(0,y.Z)("div",{target:"e1eh795y3",label:"Cropper"})("position:absolute;border:2px dashed ",(function(e){return e.theme.gray300}),";"),E=(0,y.Z)("div",{target:"e1eh795y4",label:"Resizer"})("border-radius:5px;width:10px;height:10px;position:absolute;background-color:",(function(e){return e.theme.gray300}),";cursor:",(function(e){return"".concat(e.position,"-resize")}),";",(function(e){return I[e.position].map((function(e){return"".concat(e,": -5px;")}))})),M=(0,y.Z)("canvas",{target:"e1eh795y5",label:"HiddenCanvas"})({name:"1hyfx7x",styles:"display:none;"}),L=n("./app/components/button.tsx"),A=n("./app/components/links/externalLink.tsx"),T=n("./app/components/loadingError.tsx"),W=n("./app/components/loadingIndicator.tsx"),X=n("./app/components/panels/index.tsx"),Y=n("./app/utils/withApi.tsx"),H=n("./app/views/settings/components/forms/controls/radioGroup.tsx");function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q=function(e){m()(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=b()(t);if(n){var a=b()(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return v()(this,e)});function o(){var e;l()(this,o);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=r.call.apply(r,[this].concat(n))).state={model:e.props.model,savedDataUrl:null,dataUrl:null,hasError:!1},e.handleSaveSettings=function(t){var n=e.props,r=n.endpoint,a=n.api,o=e.state,i=o.model,s=o.dataUrl;t.preventDefault();var l,u=i&&i.avatar?i.avatar.avatarType:void 0;l={avatar_photo:s?s.split(",")[1]:void 0,avatar_type:u},a.request(r,{method:"PUT",data:l,success:function(t){e.setState({savedDataUrl:e.state.dataUrl}),e.handleSuccess(t)},error:e.handleError.bind(d()(e),"There was an error saving your preferences.")})},e.handleChange=function(t){var n,r;return e.updateState(B(B({},e.state.model),{},{avatar:{avatarUuid:null!==(n=null===(r=e.state.model.avatar)||void 0===r?void 0:r.avatarUuid)&&void 0!==n?n:"",avatarType:t}}))},e}return c()(o,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){void 0!==e.model&&this.setState({model:e.model})}},{key:"updateState",value:function(e){this.setState({model:e})}},{key:"handleError",value:function(e){(0,S.Iw)(e)}},{key:"handleSuccess",value:function(e){var t=this.props.onSave;this.setState({model:e}),t(e),(0,S.S9)((0,z.t)("Successfully saved avatar preferences"))}},{key:"render",value:function(){var e,t,n=this,r=this.props,o=r.allowGravatar,i=r.allowUpload,s=r.allowLetter,l=r.savedDataUrl,u=r.type,c=r.isUser,p=r.disabled,d=this.state,f=d.hasError,m=d.model;if(f)return(0,j.tZ)(T.Z,null);if(!m)return(0,j.tZ)(W.Z,null);var g=null!==(e=null===(t=m.avatar)||void 0===t?void 0:t.avatarType)&&void 0!==e?e:"letter_avatar",v="letter_avatar"===g,h="team"===u,b="organization"===u,y=[];return s&&y.push(["letter_avatar",(0,z.t)("Use initials")]),i&&y.push(["upload",(0,z.t)("Upload an image")]),o&&y.push(["gravatar",(0,z.t)("Use Gravatar")]),(0,j.tZ)(X.s_,null,(0,j.tZ)(X.V9,null,(0,z.t)("Avatar")),(0,j.tZ)(X.N,null,(0,j.tZ)(V,null,(0,j.tZ)(F,{inline:v},(0,j.tZ)(H.Z,{style:{flex:1},choices:y,value:g,label:(0,z.t)("Avatar Type"),onChange:this.handleChange,disabled:p}),v&&(0,j.tZ)(x.Z,{gravatar:!1,style:{width:90,height:90},user:c?m:void 0,organization:b?m:void 0,team:h?m:void 0})),(0,j.tZ)(K,null,o&&"gravatar"===g&&(0,j.tZ)(D,null,(0,z.t)("Gravatars are managed through "),(0,j.tZ)(A.Z,{href:"http://gravatar.com"},"Gravatar.com")),m.avatar&&"upload"===g&&(0,j.tZ)(N,a()({},this.props,{type:u,model:m,savedDataUrl:l,updateDataUrlState:function(e){return n.setState(e)}})),(0,j.tZ)(J,{className:"form-actions"},(0,j.tZ)(L.ZP,{type:"button",priority:"primary",onClick:this.handleSaveSettings,disabled:p},(0,z.t)("Save Avatar")))))))}}]),o}(Z.Component);q.displayName="AvatarChooser",q.defaultProps={allowGravatar:!0,allowLetter:!0,allowUpload:!0,type:"user",onSave:function(){}};var F=(0,y.Z)("div",{target:"e19alrnp0",label:"AvatarGroup"})("display:flex;flex-direction:",(function(e){return e.inline?"row":"column"}),";"),V=(0,y.Z)("div",{target:"e19alrnp1",label:"AvatarForm"})({name:"cn3j3q",styles:"line-height:1.5em;padding:1em 1.25em;"}),J=(0,y.Z)("fieldset",{target:"e19alrnp2",label:"AvatarSubmit"})({name:"1l4tjll",styles:"display:flex;justify-content:flex-end;margin-top:1em;"}),K=(0,y.Z)("div",{target:"e19alrnp3",label:"AvatarUploadSection"})({name:"16f1609",styles:"margin-top:1em;"});const Q=(0,Y.Z)(q)},"./app/views/settings/components/settingsPageHeader.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>k});var r=n("../../../../node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),a=n.n(r),o=n("../../../../node_modules/@babel/runtime/helpers/classCallCheck.js"),i=n.n(o),s=n("../../../../node_modules/@babel/runtime/helpers/createClass.js"),l=n.n(s),u=n("../../../../node_modules/@babel/runtime/helpers/inherits.js"),c=n.n(u),p=n("../../../../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=n.n(p),f=n("../../../../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(f),g=n("../../../../node_modules/@emotion/styled-base/dist/styled-base.browser.esm.js"),v=n("../../../../node_modules/react/index.js"),h=n("./app/styles/organization.tsx"),b=n("./app/styles/space.tsx"),y=n("../../../../node_modules/@emotion/core/dist/core.browser.esm.js");var Z=function(e){c()(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=m()(t);if(n){var a=m()(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return d()(this,e)});function o(){return i()(this,o),r.apply(this,arguments)}return l()(o,[{key:"render",value:function(){var e=this.props,t=e.icon,n=e.title,r=e.subtitle,o=e.action,i=e.tabs,s=e.noTitleStyles,l=e.body,u=a()(e,["icon","title","subtitle","action","tabs","noTitleStyles","body"]),c=!r;return(0,y.tZ)("div",u,(0,y.tZ)(S,{isNarrow:c},(0,y.tZ)(x,null,t&&(0,y.tZ)(z,null,t),n&&(0,y.tZ)(D,{tabs:i,styled:s},(0,y.tZ)(h.Gh,null,n),r&&(0,y.tZ)(w,null,r))),o&&(0,y.tZ)(j,{isNarrow:c},o)),l&&(0,y.tZ)(_,null,l),i&&(0,y.tZ)(I,null,i))}}]),o}(v.Component);Z.displayName="UnstyledSettingsPageHeader",Z.defaultProps={noTitleStyles:!1};var S=(0,g.Z)("div",{target:"e1uay4fd0",label:"TitleAndActions"})("display:flex;align-items:",(function(e){return e.isNarrow?"center":"flex-start"}),";"),x=(0,g.Z)("div",{target:"e1uay4fd1",label:"TitleWrapper"})({name:"1rr4qq7",styles:"flex:1;"}),D=(0,g.Z)("div",{target:"e1uay4fd2",label:"Title"})((function(e){return!e.styled&&"font-size: 20px; font-weight: 600;"}),";margin:",(0,b.Z)(4)," ",(0,b.Z)(2)," ",(0,b.Z)(3)," 0;"),w=(0,g.Z)("div",{target:"e1uay4fd3",label:"Subtitle"})("color:",(function(e){return e.theme.gray400}),";font-weight:400;font-size:",(function(e){return e.theme.fontSizeLarge}),";padding:",(0,b.Z)(1.5)," 0 0;"),z=(0,g.Z)("div",{target:"e1uay4fd4",label:"Icon"})("margin-right:",(0,b.Z)(1),";"),j=(0,g.Z)("div",{target:"e1uay4fd5",label:"Action"})("margin-top:",(function(e){return e.isNarrow?"0":(0,b.Z)(4)}),";"),O=(0,g.Z)(Z,{target:"e1uay4fd6",label:"SettingsPageHeader"})("font-size:14px;margin-top:-",(0,b.Z)(4),";"),_=(0,g.Z)("div",{target:"e1uay4fd7",label:"BodyWrapper"})("flex:1;margin:0 0 ",(0,b.Z)(3),";"),I=(0,g.Z)("div",{target:"e1uay4fd8",label:"TabsWrapper"})({name:"8k0ai7",styles:"flex:1;margin:0;"});const k=O}}]);
//# sourceMappingURL=app_components_avatarChooser_tsx-app_views_settings_components_settingsPageHeader_tsx.js.map