(self.webpackChunk=self.webpackChunk||[]).push([["DiffModal"],{"./app/components/modals/diffModal.tsx":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>$,modalCss:()=>U});var r=n("../../../../node_modules/@babel/runtime/helpers/extends.js"),o=n.n(r),a=n("../../../../node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),s=n.n(a),i=n("../../../../node_modules/react/index.js"),l=n("../../../../node_modules/@emotion/core/dist/core.browser.esm.js"),u=n("../../../../node_modules/@babel/runtime/helpers/slicedToArray.js"),c=n.n(u),f=n("../../../../node_modules/@babel/runtime/regenerator/index.js"),d=n.n(f),p=n("../../../../node_modules/@babel/runtime/helpers/asyncToGenerator.js"),m=n.n(p),v=n("../../../../node_modules/@babel/runtime/helpers/classCallCheck.js"),h=n.n(v),g=n("../../../../node_modules/@babel/runtime/helpers/createClass.js"),b=n.n(g),y=n("../../../../node_modules/@babel/runtime/helpers/inherits.js"),x=n.n(y),D=n("../../../../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),j=n.n(D),k=n("../../../../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),w=n.n(k),Z=n("../../../../node_modules/@emotion/styled-base/dist/styled-base.browser.esm.js"),I=n("../../../../node_modules/@emotion/is-prop-valid/dist/is-prop-valid.browser.esm.js"),S=n("./app/actionCreators/indicator.tsx"),C=n("./app/components/button.tsx"),E=n("./app/components/buttonBar.tsx"),_=n("./app/components/loadingIndicator.tsx"),A=n("./app/locale.tsx"),P=n("./app/styles/space.tsx"),M=n("./app/utils/getStacktraceBody.tsx"),B=n("./app/utils/withApi.tsx");function N(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?R(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw a}}}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e){var t=[(0,A.t)("Type: %s",e.type)];e.hash&&t.push((0,A.t)("Hash: %s",e.hash)),e.description&&t.push((0,A.t)("Description: %s",e.description));var n=[t.join("\n")];return e.component&&n.push(z(e.component).join("\n")),n}function z(e){if(!e.contributes)return[];var t=e.name,n=e.id,r=e.hint,o=t||n,a=o&&r?"".concat(o," (").concat(r,")"):o,s=a?[a]:[];if(e.values){var i,l=N(e.values);try{for(l.s();!(i=l.n()).done;){var u=i.value;if("string"!=typeof u){var c,f=N(z(u));try{for(f.s();!(c=f.n()).done;){var d=c.value;s.push("  ".concat(d))}}catch(e){f.e(e)}finally{f.f()}}else s.push("  ".concat(u))}}catch(e){l.e(e)}finally{l.f()}}return s}const T=function(e){return Object.values(e).map(O).flat()};var q=function(e){x()(a,e);var t,r,o=(t=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=w()(t);if(r){var o=w()(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return j()(this,e)});function a(){var e;h()(this,a);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.call.apply(o,[this].concat(n))).state={loading:!0,groupingDiff:!1,baseEvent:[],targetEvent:[],SplitDiffAsync:void 0},e.toggleDiffMode=function(){e.setState((function(e){return{groupingDiff:!e.groupingDiff,loading:!0}}),e.fetchData)},e.fetchEventData=function(){var t=m()(d().mark((function t(n,r){var o,a,s,i,l,u,c,f,p;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.props,a=o.orgId,s=o.project,i=o.api,l=e.state.groupingDiff,u=r,"latest"!==r){t.next=8;break}return t.next=6,i.requestPromise("/issues/".concat(n,"/events/latest/"));case 6:c=t.sent,u=c.eventID;case 8:if(!l){t.next=13;break}return t.next=11,i.requestPromise("/projects/".concat(a,"/").concat(s.slug,"/events/").concat(u,"/grouping-info/"));case 11:return f=t.sent,t.abrupt("return",T(f));case 13:return t.next=15,i.requestPromise("/projects/".concat(a,"/").concat(s.slug,"/events/").concat(u,"/"));case 15:return p=t.sent,t.abrupt("return",(0,M.Z)(p));case 17:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e}return b()(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"fetchData",value:function(){var e=this,t=this.props,r=t.baseIssueId,o=t.targetIssueId,a=t.baseEventId,s=t.targetEventId;Promise.all([n.e("splitDiff").then(n.bind(n,"./app/components/splitDiff.tsx")),this.fetchEventData(r,null!=a?a:"latest"),this.fetchEventData(o,null!=s?s:"latest")]).then((function(t){var n=c()(t,3),r=n[0].default,o=n[1],a=n[2];e.setState({SplitDiffAsync:r,baseEvent:o,targetEvent:a,loading:!1})})).catch((function(){(0,S.Iw)((0,A.t)("Error loading events"))}))}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.project,r=this.state,o=r.SplitDiffAsync,a=r.loading,s=r.groupingDiff,i=r.baseEvent,u=r.targetEvent,c=n.features.includes("similarity-view-v2");return(0,l.tZ)(W,{className:t,loading:a},a&&(0,l.tZ)(_.Z,null),!a&&c&&(0,l.tZ)(F,null,(0,l.tZ)(E.Z,{merged:!0,active:s?"grouping":"event"},(0,l.tZ)(C.ZP,{barId:"event",size:"small",onClick:this.toggleDiffMode},(0,A.t)("Diff stack trace and message")),(0,l.tZ)(C.ZP,{barId:"grouping",size:"small",onClick:this.toggleDiffMode},(0,A.t)("Diff grouping information")))),!a&&o&&i.map((function(e,t){var n;return(0,l.tZ)(o,{key:t,base:e,target:null!==(n=u[t])&&void 0!==n?n:"",type:"words"})})))}}]),a}(i.Component);q.displayName="IssueDiff",q.defaultProps={baseEventId:"latest",targetEventId:"latest"};const H=(0,B.Z)(q);var W=(0,Z.Z)("div",{shouldForwardProp:function(e){return(0,I.Z)(e)&&"loading"!==e},target:"e13n3zub0",label:"StyledIssueDiff"})("background-color:",(function(e){return e.theme.backgroundSecondary}),";overflow:auto;padding:",(0,P.Z)(1),";flex:1;display:flex;flex-direction:column;",(function(e){return e.loading&&"\n        background-color: ".concat(e.theme.background,";\n        justify-content: center;\n      ")}),";"),F=(0,Z.Z)("div",{target:"e13n3zub1",label:"HeaderWrapper"})("display:flex;align-items:center;margin-bottom:",(0,P.Z)(2),";"),G=function(e){var t=e.className,n=e.Body,r=s()(e,["className","Body"]);return(0,l.tZ)(n,null,(0,l.tZ)(H,o()({className:t},r)))};G.displayName="DiffModal";var U={name:"1vh8okv-modalCss",styles:".modal-dialog{display:flex;margin:0;left:10px;right:10px;top:10px;bottom:10px;width:auto;}.modal-content{display:flex;flex:1;}.modal-body{display:flex;overflow:hidden;flex:1;};label:modalCss;"};const $=G},"./app/utils/getStacktraceBody.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n("./app/components/events/interfaces/rawStacktraceContent.tsx");function o(e){if(!e||!e.entries)return[];var t=e.entries.find((function(e){return"exception"===e.type}));if(!t){var n,o=e.entries.find((function(e){return"message"===e.type}));return o?(null==o||null===(n=o.data)||void 0===n?void 0:n.formatted)&&[o.data.formatted]:[]}return t.data?t.data.values.filter((function(e){return!!e.stacktrace})).map((function(t){return(0,r.ZP)(t.stacktrace,e.platform,t)})).reduce((function(e,t){return e.concat(t)}),[]):[]}}}]);
//# sourceMappingURL=DiffModal.js.map