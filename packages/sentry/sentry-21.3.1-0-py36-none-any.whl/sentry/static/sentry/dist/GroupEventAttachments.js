(self.webpackChunk=self.webpackChunk||[]).push([["GroupEventAttachments"],{"./app/components/acl/role.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var r=n("../../../../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),s=n("../../../../node_modules/@babel/runtime/helpers/createClass.js"),a=n.n(s),l=n("../../../../node_modules/@babel/runtime/helpers/inherits.js"),i=n.n(l),u=n("../../../../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=n.n(u),d=n("../../../../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=n.n(d),m=n("../../../../node_modules/react/index.js"),h=n("./app/stores/configStore.tsx"),f=n("./app/utils/isRenderFunc.tsx"),b=n("./app/utils/withOrganization.tsx");var v=function(e){i()(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=p()(t);if(n){var o=p()(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return c()(this,e)});function s(){return o()(this,s),r.apply(this,arguments)}return a()(s,[{key:"hasRole",value:function(){var e,t=h.Z.get("user"),n=this.props,r=n.organization,o=n.role,s=r.availableRoles,a=null!==(e=r.role)&&void 0!==e?e:"";if(!t)return!1;if(t.isSuperuser)return!0;if(!Array.isArray(s))return!1;var l=s.map((function(e){return e.id}));if(!l.includes(o)||!l.includes(a))return!1;var i=l.indexOf(o);return l.indexOf(a)>=i}},{key:"render",value:function(){var e=this.props.children,t=this.hasRole();return(0,f.l)(e)?e({hasRole:t}):t&&e?e:null}}]),s}(m.Component);v.displayName="Role";const y=(0,b.Z)(v)},"./app/components/events/eventAttachmentActions.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>P});var r=n("../../../../node_modules/@babel/runtime/regenerator/index.js"),o=n.n(r),s=n("../../../../node_modules/@babel/runtime/helpers/asyncToGenerator.js"),a=n.n(s),l=n("../../../../node_modules/@babel/runtime/helpers/classCallCheck.js"),i=n.n(l),u=n("../../../../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(u),d=n("../../../../node_modules/@babel/runtime/helpers/inherits.js"),p=n.n(d),m=n("../../../../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),h=n.n(m),f=n("../../../../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),b=n.n(f),v=n("../../../../node_modules/@emotion/styled-base/dist/styled-base.browser.esm.js"),y=n("../../../../node_modules/react/index.js"),j=n("./app/components/button.tsx"),g=n("./app/components/buttonBar.tsx"),Z=n("./app/components/confirm.tsx"),x=n("./app/icons/index.tsx"),_=n("./app/locale.tsx"),w=n("./app/styles/space.tsx"),O=n("./app/utils/withApi.tsx"),D=n("../../../../node_modules/@emotion/core/dist/core.browser.esm.js");var R=function(e){p()(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=b()(t);if(n){var o=b()(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return h()(this,e)});function s(){var e;i()(this,s);for(var t=arguments.length,n=new Array(t),l=0;l<t;l++)n[l]=arguments[l];return(e=r.call.apply(r,[this].concat(n))).handleDelete=a()(o().mark((function t(){var n,r,s,a,l;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.props,r=n.api,s=n.url,a=n.onDelete,l=n.attachmentId,!s){t.next=10;break}return t.prev=2,t.next=5,r.requestPromise(s,{method:"DELETE"});case 5:a(l),t.next=10;break;case 8:t.prev=8,t.t0=t.catch(2);case 10:case"end":return t.stop()}}),t,null,[[2,8]])}))),e}return c()(s,[{key:"handlePreview",value:function(){var e=this.props,t=e.onPreview,n=e.attachmentId;t&&t(n)}},{key:"render",value:function(){var e=this,t=this.props,n=t.url,r=t.withPreviewButton,o=t.hasPreview,s=t.previewIsOpen;return(0,D.tZ)(g.Z,{gap:1},(0,D.tZ)(Z.Z,{confirmText:(0,_.t)("Delete"),message:(0,_.t)("Are you sure you wish to delete this file?"),priority:"danger",onConfirm:this.handleDelete,disabled:!n},(0,D.tZ)(j.ZP,{size:"xsmall",icon:(0,D.tZ)(x.Fz,{size:"xs"}),label:(0,_.t)("Delete"),disabled:!n,title:n?void 0:(0,_.t)("Insufficient permissions to delete attachments")})),(0,D.tZ)(A,{size:"xsmall",icon:(0,D.tZ)(x.Dj,{size:"xs"}),href:n?"".concat(n,"?download=1"):"",disabled:!n,title:n?void 0:(0,_.t)("Insufficient permissions to download attachments"),label:(0,_.t)("Download")}),r&&(0,D.tZ)(A,{size:"xsmall",disabled:!n||!o,priority:s?"primary":"default",icon:(0,D.tZ)(x.fn,{size:"xs"}),onClick:function(){return e.handlePreview()},title:n?o?void 0:(0,_.t)("This attachment cannot be previewed"):(0,_.t)("Insufficient permissions to preview attachments")},(0,_.t)("Preview")))}}]),s}(y.Component);R.displayName="EventAttachmentActions";var A=(0,v.Z)(j.ZP,{target:"ewomrm90",label:"DownloadButton"})("margin-right:",(0,w.Z)(.5),";");const P=(0,O.Z)(R)},"./app/components/fileSize.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>l}),n("../../../../node_modules/react/index.js");var r=n("./app/utils.tsx"),o=n("./app/utils/getDynamicText.tsx"),s=n("../../../../node_modules/@emotion/core/dist/core.browser.esm.js");function a(e){var t=e.className,n=e.bytes;return(0,s.tZ)("span",{className:t},(0,o.Z)({value:(0,r.F)(n),fixed:"xx KB"}))}a.displayName="FileSize";const l=a},"./app/utils/attachmentUrl.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var r=n("../../../../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),s=n("../../../../node_modules/@babel/runtime/helpers/createClass.js"),a=n.n(s),l=n("../../../../node_modules/@babel/runtime/helpers/inherits.js"),i=n.n(l),u=n("../../../../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=n.n(u),d=n("../../../../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=n.n(d),m=n("../../../../node_modules/react/index.js"),h=n("./app/components/acl/role.tsx"),f=n("./app/utils/withOrganization.tsx"),b=n("../../../../node_modules/@emotion/core/dist/core.browser.esm.js");var v=function(e){i()(s,e);var t,n,r=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=p()(t);if(n){var o=p()(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return c()(this,e)});function s(){return o()(this,s),r.apply(this,arguments)}return a()(s,[{key:"getDownloadUrl",value:function(){var e=this.props,t=e.attachment,n=e.organization,r=e.eventId,o=e.projectId;return"/api/0/projects/".concat(n.slug,"/").concat(o,"/events/").concat(r,"/attachments/").concat(t.id,"/")}},{key:"render",value:function(){var e=this,t=this.props,n=t.children,r=t.organization;return(0,b.tZ)(h.Z,{role:r.attachmentsRole},(function(t){var r=t.hasRole;return n(r?e.getDownloadUrl():null)}))}}]),s}(m.PureComponent);v.displayName="AttachmentUrl";const y=(0,f.Z)(v)},"./app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsFilter.tsx":(e,t,n)=>{"use strict";n.d(t,{M:()=>y,Z:()=>Z});var r=n("../../../../node_modules/@babel/runtime/helpers/defineProperty.js"),o=n.n(r),s=n("../../../../node_modules/@emotion/styled-base/dist/styled-base.browser.esm.js"),a=(n("../../../../node_modules/react/index.js"),n("../../../../node_modules/react-router/es/index.js")),l=n("../../../../node_modules/lodash/omit.js"),i=n.n(l),u=n("../../../../node_modules/lodash/xor.js"),c=n.n(u),d=n("./app/components/button.tsx"),p=n("./app/components/buttonBar.tsx"),m=n("./app/locale.tsx"),h=n("./app/styles/space.tsx"),f=n("../../../../node_modules/@emotion/core/dist/core.browser.esm.js");function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=["event.minidump","event.applecrashreport"],j=function(e){var t=e.location,n=t.query,r=t.pathname,o=n.types,s=i()(n,"types"),a=v(v({},n),{},{types:y}),l="";return void 0===o?l="all":0===c()(y,o).length&&(l="onlyCrash"),(0,f.tZ)(g,null,(0,f.tZ)(p.Z,{merged:!0,active:l},(0,f.tZ)(d.ZP,{barId:"all",size:"small",to:{pathname:r,query:s}},(0,m.t)("All Attachments")),(0,f.tZ)(d.ZP,{barId:"onlyCrash",size:"small",to:{pathname:r,query:a}},(0,m.t)("Only Crash Reports"))))};j.displayName="GroupEventAttachmentsFilter";var g=(0,s.Z)("div",{target:"eoyp7bi0",label:"FilterWrapper"})("display:flex;justify-content:flex-end;margin-bottom:",(0,h.Z)(3),";");const Z=(0,a.withRouter)(j)},"./app/views/organizationGroupDetails/groupEventAttachments/index.tsx":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Y});var r=n("../../../../node_modules/react/index.js"),o=n("./app/components/acl/feature.tsx"),s=n("./app/components/acl/featureDisabled.tsx"),a=n("./app/utils/withOrganization.tsx"),l=n("../../../../node_modules/@babel/runtime/helpers/defineProperty.js"),i=n.n(l),u=n("../../../../node_modules/@babel/runtime/helpers/toConsumableArray.js"),c=n.n(u),d=n("../../../../node_modules/@babel/runtime/helpers/classCallCheck.js"),p=n.n(d),m=n("../../../../node_modules/@babel/runtime/helpers/createClass.js"),h=n.n(m),f=n("../../../../node_modules/@babel/runtime/helpers/get.js"),b=n.n(f),v=n("../../../../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),j=n("../../../../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),g=n.n(j),Z=n("../../../../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),x=n.n(Z),_=n("../../../../node_modules/react-router/es/index.js"),w=n("../../../../node_modules/lodash/pick.js"),O=n.n(w),D=n("./app/components/asyncComponent.tsx"),R=n("./app/components/emptyStateWarning.tsx"),A=n("./app/components/loadingIndicator.tsx"),P=n("./app/components/pagination.tsx"),k=n("./app/components/panels/index.tsx"),I=n("./app/locale.tsx"),C=n("./app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsFilter.tsx"),z=n("../../../../node_modules/@emotion/styled-base/dist/styled-base.browser.esm.js"),E=n("./app/components/dateTime.tsx"),S=n("./app/components/events/eventAttachmentActions.tsx"),B=n("./app/components/fileSize.tsx"),N=n("./app/components/links/link.tsx"),q=n("./app/utils/attachmentUrl.tsx"),F={"event.minidump":(0,I.t)("Minidump"),"event.applecrashreport":(0,I.t)("Apple Crash Report"),"event.attachment":(0,I.t)("Other")},T=n("../../../../node_modules/@emotion/core/dist/core.browser.esm.js"),G=function(e){var t=e.attachment,n=e.projectId,r=e.onDelete,o=e.isDeleted,s=e.orgId,a=e.groupId;return(0,T.tZ)(U,{isDeleted:o},(0,T.tZ)("td",null,(0,T.tZ)("h5",null,t.name,(0,T.tZ)("br",null),(0,T.tZ)("small",null,(0,T.tZ)(E.Z,{date:t.dateCreated})," Â·"," ",(0,T.tZ)(N.Z,{to:"/organizations/".concat(s,"/issues/").concat(a,"/events/").concat(t.event_id,"/")},t.event_id)))),(0,T.tZ)("td",null,F[t.type]||(0,I.t)("Other")),(0,T.tZ)("td",null,(0,T.tZ)(B.Z,{bytes:t.size})),(0,T.tZ)("td",null,(0,T.tZ)(L,null,(0,T.tZ)(q.Z,{projectId:n,eventId:t.event_id,attachment:t},(function(e){return!o&&(0,T.tZ)(S.Z,{url:e,onDelete:r,attachmentId:t.id})})))))};G.displayName="GroupEventAttachmentsTableRow";var U=(0,z.Z)("tr",{target:"ekv38qo0",label:"TableRow"})("opacity:",(function(e){return e.isDeleted?.3:1}),";td{text-decoration:",(function(e){return e.isDeleted?"line-through":"normal"}),";}"),L=(0,z.Z)("div",{target:"ekv38qo1",label:"ActionsWrapper"})({name:"1baulvz",styles:"display:inline-block;"});const W=G;var M=function(e){var t=e.attachments,n=e.orgId,r=e.projectId,o=e.groupId,s=e.onDelete,a=e.deletedAttachments,l=[(0,I.t)("Name"),(0,I.t)("Type"),(0,I.t)("Size"),(0,I.t)("Actions")];return(0,T.tZ)("table",{className:"table events-table"},(0,T.tZ)("thead",null,(0,T.tZ)("tr",null,l.map((function(e){return(0,T.tZ)("th",{key:e},e)})))),(0,T.tZ)("tbody",null,t.map((function(e){return(0,T.tZ)(W,{key:e.id,attachment:e,orgId:n,projectId:r,groupId:o,onDelete:s,isDeleted:a.some((function(t){return e.id===t}))})}))))};M.displayName="GroupEventAttachmentsTable";const Q=M;function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K=function(e){y()(s,e);var t,n,o=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=x()(t);if(n){var o=x()(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return g()(this,e)});function s(){var e;p()(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=o.call.apply(o,[this].concat(n))).handleDelete=function(t){e.setState((function(e){return{deletedAttachments:[].concat(c()(e.deletedAttachments),[t])}}))},e}return h()(s,[{key:"getDefaultState",value:function(){return H(H({},b()(x()(s.prototype),"getDefaultState",this).call(this)),{},{deletedAttachments:[]})}},{key:"getEndpoints",value:function(){var e=this.props,t=e.params,n=e.location;return[["eventAttachments","/issues/".concat(t.groupId,"/attachments/"),{query:H(H({},O()(n.query,["cursor","environment","types"])),{},{limit:50})}]]}},{key:"renderNoQueryResults",value:function(){return(0,T.tZ)(R.Z,null,(0,T.tZ)("p",null,(0,I.t)("Sorry, no event attachments match your search query.")))}},{key:"renderEmpty",value:function(){return(0,T.tZ)(R.Z,null,(0,T.tZ)("p",null,(0,I.t)("There don't seem to be any event attachments yet.")))}},{key:"renderLoading",value:function(){return this.renderBody()}},{key:"renderInnerBody",value:function(){var e=this.props,t=e.projectSlug,n=e.params,r=e.location,o=this.state,s=o.loading,a=o.eventAttachments,l=o.deletedAttachments;return s?(0,T.tZ)(A.Z,null):a.length>0?(0,T.tZ)(Q,{attachments:a,orgId:n.orgId,projectId:t,groupId:n.groupId,onDelete:this.handleDelete,deletedAttachments:l}):r.query.types?this.renderNoQueryResults():this.renderEmpty()}},{key:"renderBody",value:function(){return(0,T.tZ)(r.Fragment,null,(0,T.tZ)(C.Z,null),(0,T.tZ)(k.s_,{className:"event-list"},(0,T.tZ)(k.N,null,this.renderInnerBody())),(0,T.tZ)(P.Z,{pageLinks:this.state.eventAttachmentsPageLinks}))}}]),s}(D.Z);const J=_.withRouter(K);var V=function(e){var t=e.organization,n=e.group;return(0,T.tZ)(o.Z,{features:["event-attachments"],organization:t,renderDisabled:function(e){return(0,T.tZ)(s.Z,e)}},(0,T.tZ)(J,{projectSlug:n.project.slug}))};V.displayName="GroupEventAttachmentsContainer";const Y=(0,a.Z)(V)},"../../../../node_modules/lodash/_baseDifference.js":(e,t,n)=>{var r=n("../../../../node_modules/lodash/_SetCache.js"),o=n("../../../../node_modules/lodash/_arrayIncludes.js"),s=n("../../../../node_modules/lodash/_arrayIncludesWith.js"),a=n("../../../../node_modules/lodash/_arrayMap.js"),l=n("../../../../node_modules/lodash/_baseUnary.js"),i=n("../../../../node_modules/lodash/_cacheHas.js");e.exports=function(e,t,n,u){var c=-1,d=o,p=!0,m=e.length,h=[],f=t.length;if(!m)return h;n&&(t=a(t,l(n))),u?(d=s,p=!1):t.length>=200&&(d=i,p=!1,t=new r(t));e:for(;++c<m;){var b=e[c],v=null==n?b:n(b);if(b=u||0!==b?b:0,p&&v==v){for(var y=f;y--;)if(t[y]===v)continue e;h.push(b)}else d(t,v,u)||h.push(b)}return h}},"../../../../node_modules/lodash/_baseXor.js":(e,t,n)=>{var r=n("../../../../node_modules/lodash/_baseDifference.js"),o=n("../../../../node_modules/lodash/_baseFlatten.js"),s=n("../../../../node_modules/lodash/_baseUniq.js");e.exports=function(e,t,n){var a=e.length;if(a<2)return a?s(e[0]):[];for(var l=-1,i=Array(a);++l<a;)for(var u=e[l],c=-1;++c<a;)c!=l&&(i[l]=r(i[l]||u,e[c],t,n));return s(o(i,1),t,n)}},"../../../../node_modules/lodash/xor.js":(e,t,n)=>{var r=n("../../../../node_modules/lodash/_arrayFilter.js"),o=n("../../../../node_modules/lodash/_baseRest.js"),s=n("../../../../node_modules/lodash/_baseXor.js"),a=n("../../../../node_modules/lodash/isArrayLikeObject.js"),l=o((function(e){return s(r(e,a))}));e.exports=l}}]);
//# sourceMappingURL=GroupEventAttachments.js.map