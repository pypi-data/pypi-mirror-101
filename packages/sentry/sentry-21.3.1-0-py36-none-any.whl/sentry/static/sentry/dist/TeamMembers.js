(self.webpackChunk=self.webpackChunk||[]).push([["TeamMembers"],{"./app/actionCreators/teams.tsx":(e,t,r)=>{"use strict";r.d(t,{eM:()=>c,z_:()=>u,fs:()=>d,um:()=>l,s:()=>p,Cm:()=>f,tT:()=>g});var a=r("./app/actionCreators/indicator.tsx"),n=r("./app/actions/teamActions.tsx"),o=r("./app/locale.tsx"),s=r("./app/utils/callIfFunction.tsx"),i=r("./app/utils/guid.tsx"),m=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=arguments.length,a=new Array(r>2?r-2:0),n=2;n<r;n++)a[n-2]=arguments[n];s.g.apply(void 0,[e[t]].concat(a))};function c(e,t,r){return n.Z.fetchDetails(t.teamId),e.request("/teams/".concat(t.orgId,"/").concat(t.teamId,"/"),{success:function(e){n.Z.fetchDetailsSuccess(t.teamId,e),m(r,"success",e)},error:function(e){n.Z.fetchDetailsError(t.teamId,e),m(r,"error",e)}})}function u(e,t){n.Z.updateSuccess(e,t)}function d(e,t,r){var a="/teams/".concat(t.orgId,"/").concat(t.teamId,"/");return n.Z.update(t.teamId,t.data),e.request(a,{method:"PUT",data:t.data,success:function(e){u(t.teamId,e),m(r,"success",e)},error:function(e){n.Z.updateError(t.teamId,e),m(r,"error",e)}})}function l(e,t,r){var a,o="/organizations/".concat(t.orgId,"/members/").concat(null!==(a=t.memberId)&&void 0!==a?a:"me","/teams/").concat(t.teamId,"/"),s=(0,i.E)();return n.Z.update(s,t.teamId),e.request(o,{method:"POST",success:function(e){n.Z.updateSuccess(t.teamId,e),m(r,"success",e)},error:function(e){n.Z.updateError(s,t.teamId,e),m(r,"error",e)}})}function p(e,t,r){var a="/organizations/".concat(t.orgId,"/members/").concat(t.memberId||"me","/teams/").concat(t.teamId,"/"),o=(0,i.E)();return n.Z.update(o,t.teamId),e.request(a,{method:"DELETE",success:function(e){n.Z.updateSuccess(t.teamId,e),m(r,"success",e)},error:function(e){n.Z.updateError(o,t.teamId,e),m(r,"error",e)}})}function f(e,t,r){return n.Z.createTeam(t),e.requestPromise("/organizations/".concat(r.orgId,"/teams/"),{method:"POST",data:t}).then((function(e){return n.Z.createTeamSuccess(e),(0,a.S9)((0,o._N)("[team] has been added to the [organization] organization",{team:"#".concat(e.slug),organization:r.orgId})),e}),(function(e){throw n.Z.createTeamError(t.slug,e),(0,a.Iw)((0,o._N)("Unable to create [team] in the [organization] organization",{team:"#".concat(t.slug),organization:r.orgId})),e}))}function g(e,t){return n.Z.removeTeam(t.teamId),e.requestPromise("/teams/".concat(t.orgId,"/").concat(t.teamId,"/"),{method:"DELETE"}).then((function(e){return n.Z.removeTeamSuccess(t.teamId,e),(0,a.S9)((0,o._N)("[team] has been removed from the [organization] organization",{team:"#".concat(t.teamId),organization:t.orgId})),e}),(function(e){throw n.Z.removeTeamError(t.teamId,e),(0,a.Iw)((0,o._N)("Unable to remove [team] from the [organization] organization",{team:"#".concat(t.teamId),organization:t.orgId})),e}))}},"./app/views/settings/organizationTeams/teamMembers.tsx":(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>W});var a=r("../../../../node_modules/@babel/runtime/regenerator/index.js"),n=r.n(a),o=r("../../../../node_modules/@babel/runtime/helpers/asyncToGenerator.js"),s=r.n(o),i=r("../../../../node_modules/@babel/runtime/helpers/classCallCheck.js"),m=r.n(i),c=r("../../../../node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(c),d=r("../../../../node_modules/@babel/runtime/helpers/inherits.js"),l=r.n(d),p=r("../../../../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=r.n(p),g=r("../../../../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(g),b=r("../../../../node_modules/@emotion/styled-base/dist/styled-base.browser.esm.js"),v=r("../../../../node_modules/react/index.js"),I=r("../../../../node_modules/lodash/debounce.js"),Z=r.n(I),y=r("./app/actionCreators/indicator.tsx"),x=r("./app/actionCreators/modal.tsx"),M=r("./app/actionCreators/teams.tsx"),w=r("./app/components/avatar/userAvatar.tsx"),S=r("./app/components/button.tsx"),z=r("./app/components/dropdownAutoComplete/index.tsx"),k=r("./app/components/dropdownButton.tsx"),C=r("./app/components/idBadge/index.tsx"),T=r("./app/components/links/link.tsx"),E=r("./app/components/loadingError.tsx"),L=r("./app/components/loadingIndicator.tsx"),q=r("./app/components/panels/index.tsx"),R=r("./app/icons/index.tsx"),_=r("./app/locale.tsx"),j=r("./app/styles/overflowEllipsis.tsx"),B=r("./app/styles/space.tsx"),D=r("./app/utils/withApi.tsx"),P=r("./app/utils/withConfig.tsx"),A=r("./app/utils/withOrganization.tsx"),N=r("./app/views/settings/components/emptyMessage.tsx"),O=r("../../../../node_modules/@emotion/core/dist/core.browser.esm.js");var F=function(e){l()(o,e);var t,r,a=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=h()(t);if(r){var n=h()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return f()(this,e)});function o(){var e;m()(this,o);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=a.call.apply(a,[this].concat(r))).state={loading:!0,error:!1,dropdownBusy:!1,teamMemberList:[],orgMemberList:[]},e.debouncedFetchMembersRequest=Z()((function(t){return e.setState({dropdownBusy:!0},(function(){return e.fetchMembersRequest(t)}))}),200),e.fetchMembersRequest=function(){var t=s()(n().mark((function t(r){var a,o,s,i,m;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props,o=a.params,s=a.api,i=o.orgId,t.prev=2,t.next=5,s.requestPromise("/organizations/".concat(i,"/members/"),{query:{query:r}});case 5:m=t.sent,e.setState({orgMemberList:m,dropdownBusy:!1}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(2),(0,y.Iw)((0,_.t)("Unable to load organization members."),{duration:2e3}),e.setState({dropdownBusy:!1});case 13:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(e){return t.apply(this,arguments)}}(),e.fetchData=s()(n().mark((function t(){var r,a,o,s;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.props,a=r.api,o=r.params,t.prev=1,t.next=4,a.requestPromise("/teams/".concat(o.orgId,"/").concat(o.teamId,"/members/"));case 4:s=t.sent,e.setState({teamMemberList:s,loading:!1,error:!1}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),e.setState({loading:!1,error:!0});case 11:e.fetchMembersRequest("");case 12:case"end":return t.stop()}}),t,null,[[1,8]])}))),e.addTeamMember=function(t){var r=e.props.params;e.setState({loading:!0}),e.debouncedFetchMembersRequest(""),(0,M.um)(e.props.api,{orgId:r.orgId,teamId:r.teamId,memberId:t.value},{success:function(){var r=e.state.orgMemberList.find((function(e){return e.id===t.value}));void 0!==r&&(e.setState({loading:!1,error:!1,teamMemberList:e.state.teamMemberList.concat([r])}),(0,y.S9)((0,_.t)("Successfully added member to team.")))},error:function(){e.setState({loading:!1}),(0,y.Iw)((0,_.t)("Unable to add team member."))}})},e.handleMemberFilterChange=function(t){e.setState({dropdownBusy:!0}),e.debouncedFetchMembersRequest(t.target.value)},e}return u()(o,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props.params;e.params.teamId===t.teamId&&e.params.orgId===t.orgId||this.setState({loading:!0,error:!1},this.fetchData)}},{key:"removeMember",value:function(e){var t=this,r=this.props.params;(0,M.s)(this.props.api,{orgId:r.orgId,teamId:r.teamId,memberId:e.id},{success:function(){t.setState({teamMemberList:t.state.teamMemberList.filter((function(t){return t.id!==e.id}))}),(0,y.S9)((0,_.t)("Successfully removed member from team."))},error:function(){return(0,y.Iw)((0,_.t)("There was an error while trying to remove a member from the team."))}})}},{key:"renderDropdown",value:function(e){var t=this,r=this.props,a=r.organization,n=r.params,o=new Set(this.state.teamMemberList.map((function(e){return e.id}))),s=!(null==a||!a.openMembership)||e,i=(this.state.orgMemberList||[]).filter((function(e){return!o.has(e.id)})).map((function(e){return{searchKey:"".concat(e.name," ").concat(e.email),value:e.id,label:(0,O.tZ)(G,null,(0,O.tZ)(J,{user:e,size:24,className:"avatar"}),(0,O.tZ)(H,null,e.name||e.email))}})),m=(0,O.tZ)(K,null,(0,_.t)("Members"),(0,O.tZ)(V,{to:"",onClick:function(){return(0,x.openInviteMembersModal)({source:"teams"})},"data-test-id":"invite-member"},(0,_.t)("Invite Member")));return(0,O.tZ)(z.Z,{items:i,alignMenu:"right",onSelect:s?this.addTeamMember:function(e){return(0,x.openTeamAccessRequestModal)({teamId:n.teamId,orgId:n.orgId,memberId:e.value})},menuHeader:m,emptyMessage:(0,_.t)("No members"),onChange:this.handleMemberFilterChange,busy:this.state.dropdownBusy,onClose:function(){return t.debouncedFetchMembersRequest("")}},(function(e){var t=e.isOpen;return(0,O.tZ)(k.Z,{isOpen:t,size:"xsmall","data-test-id":"add-member"},(0,_.t)("Add Member"))}))}},{key:"removeButton",value:function(e){var t=this;return(0,O.tZ)(S.ZP,{size:"small",icon:(0,O.tZ)(R.JZ,{size:"xs",isCircled:!0}),onClick:function(){return t.removeMember(e)},label:(0,_.t)("Remove")},(0,_.t)("Remove"))}},{key:"render",value:function(){var e=this;if(this.state.loading)return(0,O.tZ)(L.Z,null);if(this.state.error)return(0,O.tZ)(E.Z,{onRetry:this.fetchData});var t=this.props,r=t.params,a=t.organization,n=t.config,o=a.access,s=o.includes("org:write")||o.includes("team:admin");return(0,O.tZ)(q.s_,null,(0,O.tZ)(q.V9,{hasButtons:!0},(0,O.tZ)("div",null,(0,_.t)("Members")),(0,O.tZ)("div",{style:{textTransform:"none"}},this.renderDropdown(s))),this.state.teamMemberList.length?this.state.teamMemberList.map((function(t){var a=t.email===n.user.email,o=s||a;return(0,O.tZ)(U,{key:t.id},(0,O.tZ)(C.Z,{avatarSize:36,member:t,useLink:!0,orgId:r.orgId}),o&&e.removeButton(t))})):(0,O.tZ)(N.Z,{icon:(0,O.tZ)(R.qO,{size:"xl"}),size:"large"},(0,_.t)("This team has no members")))}}]),o}(v.Component);F.displayName="TeamMembers";var U=(0,b.Z)(q.Lv,{target:"egk72cf0",label:"StyledMemberContainer"})({name:"1n5rntj",styles:"justify-content:space-between;align-items:center;"}),G=(0,b.Z)("div",{target:"egk72cf1",label:"StyledUserListElement"})("display:grid;grid-template-columns:max-content 1fr;grid-gap:",(0,B.Z)(.5),";align-items:center;"),H=(0,b.Z)("div",{target:"egk72cf2",label:"StyledNameOrEmail"})("font-size:",(function(e){return e.theme.fontSizeSmall}),";",j.Z,";"),J=(0,b.Z)((function(e){return(0,O.tZ)(w.Z,e)}),{target:"egk72cf3",label:"StyledAvatar"})({name:"1hd4yna",styles:"min-width:1.75em;min-height:1.75em;width:1.5em;height:1.5em;"}),K=(0,b.Z)("div",{target:"egk72cf4",label:"StyledMembersLabel"})("display:grid;grid-template-columns:1fr max-content;padding:",(0,B.Z)(1)," 0;font-size:",(function(e){return e.theme.fontSizeExtraSmall}),";text-transform:uppercase;"),V=(0,b.Z)(T.Z,{target:"egk72cf5",label:"StyledCreateMemberLink"})({name:"geruia",styles:"text-transform:none;"});const W=(0,P.Z)((0,D.Z)((0,A.Z)(F)))}}]);
//# sourceMappingURL=TeamMembers.js.map