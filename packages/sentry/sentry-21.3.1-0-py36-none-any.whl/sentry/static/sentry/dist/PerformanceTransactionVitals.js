(self.webpackChunk=self.webpackChunk||[]).push([["PerformanceTransactionVitals"],{"./app/views/performance/breadcrumb.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>k});var r=n("../../../../node_modules/@babel/runtime/helpers/defineProperty.js"),a=n.n(r),o=n("../../../../node_modules/@babel/runtime/helpers/classCallCheck.js"),i=n.n(o),s=n("../../../../node_modules/@babel/runtime/helpers/createClass.js"),l=n.n(s),c=n("../../../../node_modules/@babel/runtime/helpers/inherits.js"),u=n.n(c),p=n("../../../../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=n.n(p),f=n("../../../../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(f),v=n("../../../../node_modules/react/index.js"),y=n("./app/components/breadcrumbs.tsx"),h=n("./app/locale.tsx"),g=n("./app/utils/queryString.tsx"),b=n("./app/views/performance/transactionSummary/utils.tsx"),x=n("./app/views/performance/transactionVitals/utils.tsx"),j=n("./app/views/performance/vitalDetail/utils.tsx"),w=n("./app/views/performance/utils.tsx"),Z=n("../../../../node_modules/@emotion/core/dist/core.browser.esm.js");function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=function(e){u()(a,e);var t,n,r=(t=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=m()(t);if(n){var a=m()(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return d()(this,e)});function a(){return i()(this,a),r.apply(this,arguments)}return l()(a,[{key:"getCrumbs",value:function(){var e=[],t=this.props,n=t.organization,r=t.location,a=t.transactionName,o=t.vitalName,i=t.eventSlug,s=t.traceSlug,l=t.transactionComparison,c=t.realUserMonitoring,u={pathname:(0,w.de)(n),query:P(P({},r.query),{},{transaction:void 0})};if(e.push({to:u,label:(0,h.t)("Performance"),preserveGlobalSelection:!0}),o){var p=(0,j.i4)({orgSlug:n.slug,vitalName:"fcp",projectID:(0,g.ro)(r.query.project),query:r.query});e.push({to:p,label:(0,h.t)("Vital Detail"),preserveGlobalSelection:!0})}else if(a)if(c){var d=(0,x.Pl)({orgSlug:n.slug,transaction:a,projectID:(0,g.ro)(r.query.project),query:r.query});e.push({to:d,label:(0,h.t)("Web Vitals"),preserveGlobalSelection:!0})}else{var f=(0,b.e1)({orgSlug:n.slug,transaction:a,projectID:(0,g.ro)(r.query.project),query:r.query});e.push({to:f,label:(0,h.t)("Transaction Summary"),preserveGlobalSelection:!0})}return a&&i?e.push({to:"",label:(0,h.t)("Event Details")}):l?e.push({to:"",label:(0,h.t)("Compare to Baseline")}):s&&e.push({to:"",label:(0,h.t)("Trace View")}),e}},{key:"render",value:function(){return(0,Z.tZ)(y.Z,{crumbs:this.getCrumbs()})}}]),a}(v.Component);S.displayName="Breadcrumb";const k=S},"./app/views/performance/transactionSummary/header.tsx":(e,t,n)=>{"use strict";n.d(t,{O:()=>N,Z:()=>B});var r=n("../../../../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=n.n(r),o=n("../../../../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../../../../node_modules/@babel/runtime/helpers/inherits.js"),l=n.n(s),c=n("../../../../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),u=n.n(c),p=n("../../../../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(p),f=n("../../../../node_modules/@emotion/styled-base/dist/styled-base.browser.esm.js"),m=n("../../../../node_modules/react/index.js"),v=n("./app/components/acl/feature.tsx"),y=n("./app/components/button.tsx"),h=n("./app/components/buttonBar.tsx"),g=n("./app/components/createAlertButton.tsx"),b=n("./app/components/layouts/thirds.tsx"),x=n("./app/components/links/listLink.tsx"),j=n("./app/components/navTabs.tsx"),w=n("./app/icons/index.tsx"),Z=n("./app/locale.tsx"),O=n("./app/utils/analytics.tsx"),P=n("./app/utils/queryString.tsx"),S=n("./app/views/performance/breadcrumb.tsx"),k=n("./app/views/performance/transactionVitals/utils.tsx"),D=n("../../../../node_modules/@babel/runtime/helpers/slicedToArray.js"),C=n.n(D),V=n("./app/actionCreators/performance.tsx"),R=n("./app/utils/withApi.tsx"),_=n("../../../../node_modules/@emotion/core/dist/core.browser.esm.js");var z=function(e){l()(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=d()(t);if(n){var a=d()(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return u()(this,e)});function o(){var e;a()(this,o);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=r.call.apply(r,[this].concat(n))).state={isLoading:!0,keyFetchID:void 0,error:null,isKeyTransaction:!1},e.fetchData=function(){var t=e.props,n=t.organization,r=t.eventView,a=t.transactionName,o=r.project;if(1===o.length){var i="/organizations/".concat(n.slug,"/is-key-transactions/"),s=Symbol("keyFetchID");e.setState({isLoading:!0,keyFetchID:s}),e.props.api.requestPromise(i,{method:"GET",includeAllArgs:!0,query:{project:o.map((function(e){return String(e)})),transaction:a}}).then((function(t){var n=C()(t,3),r=n[0];n[1],n[2],e.state.keyFetchID===s&&e.setState({isLoading:!1,keyFetchID:void 0,error:null,isKeyTransaction:!(null==r||!r.isKey)})})).catch((function(t){e.setState({isLoading:!1,keyFetchID:void 0,error:t.responseJSON.detail,isKeyTransaction:!1})}))}},e.toggleKeyTransactionHandler=function(){var t=e.props,n=t.eventView,r=t.api,a=t.organization,o=t.transactionName,i=e.state.isKeyTransaction,s=n.project;(0,O.ec)({eventName:"Performance Views: Key Transaction toggle",eventKey:"performance_views.key_transaction.toggle",orgId:parseInt(a.id,10),action:i?"remove":"add"}),(0,V.F)(r,i,a.slug,s,o).then((function(){e.setState({isKeyTransaction:!i})}))},e}return i()(o,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentDidUpdate",value:function(e){var t=e.organization.slug!==this.props.organization.slug,n=1===e.eventView.project.length&&1===this.props.eventView.project.length&&e.eventView.project[0]!==this.props.eventView.project[0];(t||n)&&this.fetchData()}},{key:"render",value:function(){var e=this.state,t=e.isKeyTransaction,n=e.isLoading;return 1!==this.props.eventView.project.length||n?null:(0,_.tZ)(y.ZP,{icon:t?(0,_.tZ)(w.GK,{color:"yellow300",isSolid:!0}):(0,_.tZ)(w.GK,null),onClick:this.toggleKeyTransactionHandler},(0,Z.t)("Key Transaction"))}}]),o}(m.Component);z.displayName="KeyTransactionButton";const q=(0,R.Z)(z);var N,T=n("./app/views/performance/transactionSummary/utils.tsx");!function(e){e[e.TransactionSummary=0]="TransactionSummary",e[e.RealUserMonitoring=1]="RealUserMonitoring"}(N||(N={}));var A=function(e){l()(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=d()(t);if(n){var a=d()(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return u()(this,e)});function o(){var e;a()(this,o);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=r.call.apply(r,[this].concat(n))).trackVitalsTabClick=function(){var t=e.props.organization;(0,O.ec)({eventKey:"performance_views.vitals.vitals_tab_clicked",eventName:"Performance Views: Vitals tab clicked",organization_id:t.id})},e.handleIncompatibleQuery=function(t,n){var r,a;e.trackAlertClick(n),null===(r=(a=e.props).handleIncompatibleQuery)||void 0===r||r.call(a,t,n)},e.handleCreateAlertSuccess=function(){e.trackAlertClick()},e}return i()(o,[{key:"trackAlertClick",value:function(e){var t=this.props.organization;(0,O.ec)({eventKey:"performance_views.summary.create_alert_clicked",eventName:"Performance Views: Create alert clicked",organization_id:t.id,status:e?"error":"success",errors:e,url:window.location.href})}},{key:"renderCreateAlertButton",value:function(){var e=this.props,t=e.eventView,n=e.organization,r=e.projects;return(0,_.tZ)(g.K,{eventView:t,organization:n,projects:r,onIncompatibleQuery:this.handleIncompatibleQuery,onSuccess:this.handleCreateAlertSuccess,referrer:"performance"})}},{key:"renderKeyTransactionButton",value:function(){var e=this.props,t=e.eventView,n=e.organization,r=e.transactionName;return(0,_.tZ)(q,{transactionName:r,eventView:t,organization:n})}},{key:"render",value:function(){var e=this,t=this.props,n=t.organization,r=t.location,a=t.transactionName,o=t.currentTab,i=t.hasWebVitals,s=(0,T.e1)({orgSlug:n.slug,transaction:a,projectID:(0,P.ro)(r.query.project),query:r.query}),l=(0,k.Pl)({orgSlug:n.slug,transaction:a,projectID:(0,P.ro)(r.query.project),query:r.query});return(0,_.tZ)(b.h4,null,(0,_.tZ)(b.oB,null,(0,_.tZ)(S.Z,{organization:n,location:r,transactionName:a,realUserMonitoring:o===N.RealUserMonitoring}),(0,_.tZ)(b.Dx,null,a)),(0,_.tZ)(b.kP,null,(0,_.tZ)(h.Z,{gap:1},(0,_.tZ)(v.Z,{organization:n,features:["incidents"]},(function(t){return t.hasFeature&&e.renderCreateAlertButton()})),this.renderKeyTransactionButton(),(0,_.tZ)(y.ZP,{href:"/settings/".concat(n.slug,"/performance/"),icon:(0,_.tZ)(w.iC,null),"aria-label":"Settings"}))),(0,_.tZ)(m.Fragment,null,(0,_.tZ)(F,null,(0,_.tZ)(x.Z,{to:s,isActive:function(){return o===N.TransactionSummary}},(0,Z.t)("Overview")),i&&(0,_.tZ)(x.Z,{to:l,isActive:function(){return o===N.RealUserMonitoring},onClick:this.trackVitalsTabClick},(0,Z.t)("Web Vitals")))))}}]),o}(m.Component);A.displayName="TransactionHeader";var F=(0,f.Z)(j.Z,{target:"enwi9i70",label:"StyledNavTabs"})({name:"n8i8z8",styles:"margin-bottom:0;width:100%;"});const B=A},"./app/views/performance/transactionVitals/constants.tsx":(e,t,n)=>{"use strict";n.d(t,{sE:()=>f,GW:()=>m,dl:()=>v,PE:()=>g,QB:()=>b});var r=n("../../../../node_modules/@babel/runtime/helpers/defineProperty.js"),a=n.n(r),o=n("../../../../node_modules/@babel/runtime/helpers/toConsumableArray.js"),i=n.n(o),s=n("./app/locale.tsx"),l=n("./app/utils/discover/fields.tsx"),c=n("./app/utils/performance/vitals/constants.tsx"),u=n("./app/utils/theme.tsx");function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f=100,m=.75,v=[{label:(0,s.t)("Exclude Outliers"),value:"exclude_outliers"},{label:(0,s.t)("View All"),value:"all"}],y=[{vitals:[l.Zl.FP,l.Zl.FCP,l.Zl.LCP],min:0},{vitals:[l.Zl.FID],min:0,precision:2},{vitals:[l.Zl.CLS],min:0,precision:2}],h=i()(u.ZP.charts.getColorPalette(y.reduce((function(e,t){return e+t.vitals.length}),0)-1)).reverse(),g=y.map((function(e){return d(d({},e),{},{colors:h.splice(0,e.vitals.length)})})),b=y.reduce((function(e,t){return t.vitals.forEach((function(t){var n=c.r[t].slug;e.push("".concat(n,"Start")),e.push("".concat(n,"End"))})),e}),[])},"./app/views/performance/transactionVitals/index.tsx":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Le});var r=n("../../../../node_modules/@babel/runtime/helpers/toConsumableArray.js"),a=n.n(r),o=n("../../../../node_modules/@babel/runtime/helpers/defineProperty.js"),i=n.n(o),s=n("../../../../node_modules/@babel/runtime/helpers/classCallCheck.js"),l=n.n(s),c=n("../../../../node_modules/@babel/runtime/helpers/createClass.js"),u=n.n(c),p=n("../../../../node_modules/@babel/runtime/helpers/inherits.js"),d=n.n(p),f=n("../../../../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),m=n.n(f),v=n("../../../../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),y=n.n(v),h=n("../../../../node_modules/@emotion/styled-base/dist/styled-base.browser.esm.js"),g=n("../../../../node_modules/react/index.js"),b=n("../../../../node_modules/react-router/es/index.js"),x=n("./app/components/acl/feature.tsx"),j=n("./app/components/alert.tsx"),w=n("./app/components/lightWeightNoProjectMessage.tsx"),Z=n("./app/components/organizations/globalSelectionHeader/index.tsx"),O=n("./app/components/sentryDocumentTitle.tsx"),P=n("./app/locale.tsx"),S=n("./app/styles/organization.tsx"),k=n("./app/utils/discover/eventView.tsx"),D=n("./app/utils/discover/fields.tsx"),C=n("./app/utils/performance/vitals/constants.tsx"),V=n("./app/utils/queryString.tsx"),R=n("./app/utils/tokenizeSearch.tsx"),_=n("./app/utils/withGlobalSelection.tsx"),z=n("./app/utils/withOrganization.tsx"),q=n("./app/utils/withProjects.tsx"),N=n("./app/views/performance/utils.tsx"),T=n("./app/views/performance/transactionVitals/constants.tsx"),A=n("./app/components/button.tsx"),F=n("./app/components/dropdownControl.tsx"),B=n("./app/components/events/searchBar.tsx"),I=n("./app/components/layouts/thirds.tsx"),E=n("./app/components/organizations/globalSelectionHeader/getParams.tsx"),L=n("./app/styles/space.tsx"),K=n("./app/utils/analytics.tsx"),M=n("./app/views/performance/transactionSummary/header.tsx"),H=n("./app/components/panels/index.tsx"),W=n("./app/utils/performance/histogram/histogramQuery.tsx"),G=n("./app/utils/performance/vitals/vitalsCardsDiscoverQuery.tsx"),Q=n("../../../../node_modules/@babel/runtime/helpers/extends.js"),U=n.n(Q),J=n("../../../../node_modules/emotion-theming/dist/emotion-theming.browser.esm.js"),Y=n("../../../../node_modules/lodash/isEqual.js"),$=n.n(Y),X=n("../../../../node_modules/lodash/throttle.js"),ee=n.n(X),te=n("./app/components/charts/barChart.tsx"),ne=n("./app/components/charts/barChartZoom.tsx"),re=n("./app/components/charts/components/markLine.tsx"),ae=n("./app/components/charts/transparentLoadingMask.tsx"),oe=n("./app/components/discoverButton.tsx"),ie=n("./app/components/placeholder.tsx"),se=n("./app/utils/formatters.tsx"),le=n("./app/utils/getDynamicText.tsx"),ce=n("./app/utils/performance/histogram/utils.tsx"),ue=n("./app/views/performance/landing/vitalsCards.tsx"),pe=n("./app/views/performance/vitalDetail/utils.tsx"),de=n("./app/components/charts/styles.tsx"),fe=(0,h.Z)(H.Lv,{target:"e8bgzy60",label:"Card"})({name:"1lczy7e",styles:"display:grid;grid-template-columns:325px minmax(100px,auto);padding:0;"}),me=(0,h.Z)("div",{target:"e8bgzy61",label:"CardSection"})("padding:",(0,L.Z)(3),";"),ve=(0,h.Z)(me,{target:"e8bgzy62",label:"CardSummary"})("position:relative;border-right:1px solid ",(function(e){return e.theme.border}),";grid-column:1/1;display:flex;flex-direction:column;justify-content:space-between;"),ye=(0,h.Z)(de.OT,{target:"e8bgzy63",label:"CardSectionHeading"})({name:"dpoqzr",styles:"margin:0px;"}),he=(0,h.Z)("div",{target:"e8bgzy64",label:"Description"})("font-size:",(function(e){return e.theme.fontSizeMedium}),";color:",(function(e){return e.theme.subText}),";"),ge=(0,h.Z)("div",{target:"e8bgzy65",label:"StatNumber"})({name:"idm3bz",styles:"font-size:32px;"}),be=n("./app/views/performance/transactionVitals/utils.tsx"),xe=n("../../../../node_modules/@emotion/core/dist/core.browser.esm.js");function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ze=function(e){d()(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=y()(t);if(n){var a=y()(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return m()(this,e)});function o(){var e;l()(this,o);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=r.call.apply(r,[this].concat(n))).state={refDataRect:null,refPixelRect:null},e.trackOpenInDiscoverClicked=function(){var t=e.props.organization,n=e.props.vitalDetails;(0,K.ec)({eventKey:"performance_views.vitals.open_in_discover",eventName:"Performance Views: Open vitals in discover",organization_id:t.id,vital:n.slug})},e.handleRendered=ee()((function(t,n){var r=e.props.chartData,a=e.state.refDataRect;if(!(null===a||r.length<1)){var o=null===a?null:(0,be.L0)(n,a);null===o||$()(o,e.state.refPixelRect)||e.setState({refPixelRect:o})}}),200,{leading:!0}),e.handleDataZoomCancelled=function(){},e}return u()(o,[{key:"showVitalColours",value:function(){return this.props.organization.features.includes("performance-vitals-overview")}},{key:"summary",get:function(){var e,t=this.props.summaryData;return null!==(e=null==t?void 0:t.p75)&&void 0!==e?e:null}},{key:"failureRate",get:function(){var e,t,n=this.props.summaryData,r=null!==(e=null==n?void 0:n.poor)&&void 0!==e?e:0,a=null!==(t=null==n?void 0:n.total)&&void 0!==t?t:0;return a<=0?0:r/a}},{key:"getFormattedStatNumber",value:function(){var e=this.props.vitalDetails,t=this.summary,n=e.type;return null===t?"—":"duration"===n?(0,se.g9)(t/1e3,2,!0):(0,se.$1)(t,2)}},{key:"renderSummary",value:function(){var e,t=this.props,n=t.vitalDetails,r=t.eventView,a=t.organization,o=t.min,i=t.max,s=n.slug,l=n.name,c=n.description,u="measurements.".concat(s),p=r.withColumns([{kind:"field",field:"transaction"},{kind:"function",function:["percentile",u,T.GW.toString()]},{kind:"function",function:["count","",""]}]).withSorts([{kind:"desc",field:(0,D.LY)("percentile(".concat(u,",").concat(T.GW.toString(),")"))}]),d=(0,R.aI)(null!==(e=p.query)&&void 0!==e?e:"");return d.addTagValues("has",[u]),void 0===o&&void 0===i||(void 0!==o&&d.addTagValues(u,[">=".concat(o)]),void 0!==i&&d.addTagValues(u,["<=".concat(i)])),p.query=(0,R.gZ)(d),(0,xe.tZ)(ve,null,(0,xe.tZ)(Oe,null,(0,xe.tZ)(ye,null,"".concat(l," (").concat(s.toUpperCase(),")"))),(0,xe.tZ)(ge,null,(0,le.Z)({value:this.getFormattedStatNumber(),fixed:"—"})),(0,xe.tZ)(he,null,c),(0,xe.tZ)("div",null,(0,xe.tZ)(oe.Z,{size:"small",to:p.getResultsViewUrlTarget(a.slug),onClick:this.trackOpenInDiscoverClicked},(0,P.t)("Open in Discover"))))}},{key:"renderHistogram",value:function(){var e=this,t=this.props,n=t.theme,r=t.location,o=t.isLoading,s=t.chartData,l=t.summaryData,c=t.error,u=t.colors,p=t.vital,d=t.vitalDetails,f=t.precision,m=void 0===f?0:f,v=d.slug,y=this.getSeries(),h={type:"category",truncate:!0,axisTick:{alignWithLabel:!0}},g=y.data.map((function(e){return e.value})),b={type:"value",max:g.length?Math.max.apply(Math,a()(g)):void 0,axisLabel:{color:n.chartLabel,formatter:se.Du}},x=[y];if(!o&&!c){var j=this.getBaselineSeries();null!==j&&x.push(j)}var w=o||c||null===l?{}:i()({},p,l);return(0,xe.tZ)(ne.Z,{minZoomWidth:Math.pow(10,-m)*T.sE,location:r,paramStart:"".concat(v,"Start"),paramEnd:"".concat(v,"End"),xAxisIndex:[0],buckets:(0,ce._W)(s),onDataZoomCancelled:this.handleDataZoomCancelled},(function(t){return(0,xe.tZ)(Pe,null,(0,xe.tZ)(ae.Z,{visible:o}),(0,xe.tZ)(Se,null,(0,xe.tZ)(ue.JO,{isLoading:o,data:w,vital:p,showBar:!1,showStates:!1,showVitalPercentNames:!1,showDurationDetail:!1})),(0,le.Z)({value:(0,xe.tZ)(te.Z,U()({series:x,xAxis:h,yAxis:b,colors:u,onRendered:e.handleRendered,grid:{left:(0,L.Z)(3),right:(0,L.Z)(3),top:(0,L.Z)(3),bottom:(0,L.Z)(1.5)},stacked:!0},t)),fixed:(0,xe.tZ)(ie.Z,{testId:"skeleton-ui",height:"200px"})}))}))}},{key:"bucketWidth",value:function(){var e=this.props.chartData;return e.length>=2?e[1].bin-e[0].bin:0}},{key:"getSeries",value:function(){var e=this,t=this.props,n=t.theme,r=t.chartData,a=t.precision,o=t.vitalDetails,i=t.vital,s=(0,ce.GT)(r,{precision:0===a?void 0:a,type:o.type,additionalFieldsFn:function(t){return e.showVitalColours()?{itemStyle:{color:n[e.getVitalsColor(i,t)]}}:{}}});return{seriesName:(0,P.t)("Count"),data:s}}},{key:"getVitalsColor",value:function(e,t){var n=pe.eE[e],r=pe.MN[e];return t>=n?pe.fL[pe.SP.POOR]:t>=r?pe.fL[pe.SP.MEH]:pe.fL[pe.SP.GOOD]}},{key:"getBaselineSeries",value:function(){var e=this.props,t=e.theme,n=e.chartData,r=this.summary;if(null===r||null===this.state.refPixelRect)return null;var o=(0,be.oZ)(n,r);if(null===o||-1===o)return null;var i=(0,be.jb)({x:o-.5,y:0},this.state.refDataRect,this.state.refPixelRect);if(null===i)return null;var s=(0,be.jb)({x:o-.5,y:Math.max.apply(Math,a()(n.map((function(e){return e.count}))))||1},this.state.refDataRect,this.state.refPixelRect);if(null===s)return null;var l=(0,re.Z)({animationDuration:200,data:[[i,s]],label:{show:!1},lineStyle:{color:t.textColor,type:"solid"}});return l.tooltip={formatter:function(){return['<div class="tooltip-series tooltip-series-solo">','<span class="tooltip-label">',"<strong>".concat((0,P.t)("p75"),"</strong>"),"</span>","</div>",'<div class="tooltip-arrow"></div>'].join("")}},{seriesName:(0,P.t)("p75"),data:[],markLine:l}}},{key:"render",value:function(){return(0,xe.tZ)(fe,null,this.renderSummary(),this.renderHistogram())}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.isLoading,r=e.error,a=e.chartData;if(n||null===r)return we({},t);var o=(0,be.eH)(a);return null===t.refDataRect||null!==o&&!$()(o,t.refDataRect)?we(we({},t),{},{refDataRect:o}):we({},t)}}]),o}(g.Component);Ze.displayName="VitalCard";var Oe=(0,h.Z)("div",{target:"e18etcac0",label:"SummaryHeading"})({name:"gg4vpm",styles:"display:flex;justify-content:space-between;"}),Pe=(0,h.Z)("div",{target:"e18etcac1",label:"Container"})({name:"79elbk",styles:"position:relative;"}),Se=(0,h.Z)("div",{target:"e18etcac2",label:"PercentContainer"})("position:absolute;top:",(0,L.Z)(2),";right:",(0,L.Z)(3),";z-index:2;");const ke=(0,J.Zz)(Ze);var De=function(e){d()(a,e);var t,n,r=(t=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=y()(t);if(n){var a=y()(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return m()(this,e)});function a(){return l()(this,a),r.apply(this,arguments)}return u()(a,[{key:"renderVitalCard",value:function(e,t,n,r,a,o,i,s,l){var c=this.props,u=c.location,p=c.organization,d=c.eventView,f=c.dataFilter,m=C.r[e],v=void 0!==i||void 0!==s;return(0,xe.tZ)(W.Z,{location:u,orgSlug:p.slug,eventView:d,numBuckets:T.sE,fields:v?[e]:[],min:i,max:s,precision:l,dataFilter:f},(function(c){var f,y,h=v?c.isLoading:t,g=v?null!==c.error:n,b=v&&null!==(f=null===(y=c.histograms)||void 0===y?void 0:y[e])&&void 0!==f?f:a;return(0,xe.tZ)(ke,{location:u,isLoading:h,error:g,vital:e,vitalDetails:m,summaryData:r,chartData:b,colors:o,eventView:d,organization:p,min:i,max:s,precision:l})}))}},{key:"renderVitalGroup",value:function(e,t){var n=this,r=this.props,a=r.location,o=r.organization,i=r.eventView,s=r.dataFilter,l=e.vitals,c=e.colors,u=e.min,p=e.max,d=e.precision,f=l.reduce((function(e,t){var n=C.r[t].slug;return e[t]={start:(0,V.ro)(a.query["".concat(n,"Start")]),end:(0,V.ro)(a.query["".concat(n,"End")])},e}),{});return(0,xe.tZ)(W.Z,{location:a,orgSlug:o.slug,eventView:i,numBuckets:T.sE,fields:l,min:u,max:p,precision:d,dataFilter:s},(function(e){var r=t.isLoading||e.isLoading,a=null!==t.error||null!==e.error;return(0,xe.tZ)(g.Fragment,null,l.map((function(o,i){var s,l,u,p,m,v=null!==(s=null==t||null===(l=t.vitalsData)||void 0===l?void 0:l[o])&&void 0!==s?s:null,y=null!==(u=null===(p=e.histograms)||void 0===p?void 0:p[o])&&void 0!==u?u:[],h=null!==(m=f[o])&&void 0!==m?m:{},b=h.start,x=h.end;return(0,xe.tZ)(g.Fragment,{key:o},n.renderVitalCard(o,r,a,v,y,[c[i]],Ce(b,d),Ce(x,d),d))})))}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.location,r=t.organization,a=t.eventView,o=T.PE.reduce((function(e,t){var n=t.vitals;return e.concat(n)}),[]);return(0,xe.tZ)(H.s_,null,(0,xe.tZ)(G.Z,{eventView:a,orgSlug:r.slug,location:n,vitals:o},(function(t){return(0,xe.tZ)(g.Fragment,null,T.PE.map((function(n){return(0,xe.tZ)(g.Fragment,{key:n.vitals.join("")},e.renderVitalGroup(n,t))})))})))}}]),a}(g.Component);function Ce(e,t){if(void 0!==e)return void 0===t||0===t?parseInt(e,10):parseFloat(e)}De.displayName="VitalsPanel";const Ve=De;function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ze=function(e){d()(a,e);var t,n,r=(t=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=y()(t);if(n){var a=y()(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return m()(this,e)});function a(){var e;l()(this,a);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.call.apply(r,[this].concat(n))).state={incompatibleAlertNotice:null},e.handleSearch=function(t){var n=e.props.location,r=(0,E.Q)(_e(_e({},n.query||{}),{},{query:t}));delete r.cursor,b.browserHistory.push({pathname:n.pathname,query:r})},e.handleIncompatibleQuery=function(t,n){var r=t((function(){return e.setState({incompatibleAlertNotice:null})}));e.setState({incompatibleAlertNotice:r})},e.handleResetView=function(){var t=e.props,n=t.location,r=t.organization;(0,K.ec)({eventKey:"performance_views.vitals.reset_view",eventName:"Performance Views: Reset vitals view",organization_id:r.id});var a=_e({},n.query);T.QB.forEach((function(e){return delete a[e]})),b.browserHistory.push({pathname:n.pathname,query:a})},e.handleFilterChange=function(t){var n=e.props,r=n.location,a=n.organization;(0,K.ec)({eventKey:"performance_views.vitals.filter_changed",eventName:"Performance Views: Change vitals filter",organization_id:a.id,value:t});var o=_e(_e({},r.query),{},{cursor:void 0,dataFilter:t});T.QB.forEach((function(e){return delete o[e]})),b.browserHistory.push({pathname:r.pathname,query:o})},e}return u()(a,[{key:"getActiveFilter",value:function(){var e=this.props.location,t=e.query.dataFilter?(0,V.ro)(e.query.dataFilter):T.dl[0].value;return T.dl.find((function(e){return e.value===t}))||T.dl[0]}},{key:"render",value:function(){var e=this,t=this.props,n=t.transactionName,r=t.location,a=t.eventView,o=t.projects,i=t.organization,s=this.state.incompatibleAlertNotice,l=(0,V.ro)(r.query.query,""),c=this.getActiveFilter(),u=T.QB.map((function(e){return r.query[e]})).some((function(e){return void 0!==e}));return(0,xe.tZ)(g.Fragment,null,(0,xe.tZ)(M.Z,{eventView:a,location:r,organization:i,projects:o,transactionName:n,currentTab:M.O.RealUserMonitoring,hasWebVitals:!0,handleIncompatibleQuery:this.handleIncompatibleQuery}),(0,xe.tZ)(I.uT,null,s&&(0,xe.tZ)(I.or,{fullWidth:!0},s),(0,xe.tZ)(I.or,{fullWidth:!0},(0,xe.tZ)(Ne,null,(0,xe.tZ)(qe,{organization:i,projectIds:a.project,query:l,fields:a.fields,onSearch:this.handleSearch}),(0,xe.tZ)(F.ZP,{buttonProps:{prefix:(0,P.t)("Filter")},label:c.label},T.dl.map((function(t){var n=t.label,r=t.value;return(0,xe.tZ)(F.hP,{key:r,onSelect:e.handleFilterChange,eventKey:r,isActive:r===c.value},n)}))),(0,xe.tZ)(A.ZP,{onClick:this.handleResetView,disabled:!u,"data-test-id":"reset-view"},(0,P.t)("Reset View"))),(0,xe.tZ)(Ve,{organization:i,location:r,eventView:a,dataFilter:c.value}))))}}]),a}(g.Component);ze.displayName="VitalsContent";var qe=(0,h.Z)(B.Z,{target:"e1atb5ss0",label:"StyledSearchBar"})({name:"i9gxme",styles:"flex-grow:1;"}),Ne=(0,h.Z)("div",{target:"e1atb5ss1",label:"StyledActions"})("display:grid;grid-gap:",(0,L.Z)(2),";grid-template-columns:auto max-content max-content;align-items:center;margin-bottom:",(0,L.Z)(3),";");const Te=ze;function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Be=function(e){d()(a,e);var t,n,r=(t=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=y()(t);if(n){var a=y()(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return m()(this,e)});function a(){var e;l()(this,a);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.call.apply(r,[this].concat(n))).state={eventView:Ee(e.props.location,(0,N.JY)(e.props.location))},e.renderNoAccess=function(){return(0,xe.tZ)(j.Z,{type:"warning"},(0,P.t)("You don't have access to this feature"))},e}return u()(a,[{key:"getDocumentTitle",value:function(){var e=(0,N.JY)(this.props.location);return"string"==typeof e&&String(e).trim().length>0?[String(e).trim(),(0,P.t)("Vitals")].join(" — "):[(0,P.t)("Summary"),(0,P.t)("Vitals")].join(" — ")}},{key:"render",value:function(){var e=this.props,t=e.organization,n=e.projects,r=e.location,a=this.state.eventView,o=(0,N.JY)(r);if(!a||void 0===o)return b.browserHistory.replace({pathname:"/organizations/".concat(t.slug,"/performance/"),query:Fe({},r.query)}),null;var i=1===a.project.length,s=i?n.find((function(e){return parseInt(e.id,10)===a.project[0]})):void 0,l=a.project.map((function(e){return n.find((function(t){return parseInt(t.id,10)===e}))})).filter((function(e){return void 0!==e})).map((function(e){return e.slug}));return(0,xe.tZ)(O.Z,{title:this.getDocumentTitle(),orgSlug:t.slug,projectSlug:null==s?void 0:s.slug},(0,xe.tZ)(x.Z,{features:["performance-view"],organization:t,renderDisabled:this.renderNoAccess},(0,xe.tZ)(Z.Z,{lockedMessageSubject:(0,P.t)("transaction"),shouldForceProject:i,forceProject:s,specificProjectSlugs:l,disableMultipleProjectSelection:!0,showProjectSettingsLink:!0},(0,xe.tZ)(Ie,null,(0,xe.tZ)(w.Z,{organization:t},(0,xe.tZ)(Te,{location:r,eventView:a,transactionName:o,organization:t,projects:n}))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return Fe(Fe({},t),{},{eventView:Ee(e.location,(0,N.JY)(e.location))})}}]),a}(g.Component);Be.displayName="TransactionVitals";var Ie=(0,h.Z)(S.JH,{target:"e1o8lmc40",label:"StyledPageContent"})({name:"y8aj3r",styles:"padding:0;"});function Ee(e,t){if(void 0!==t){var n=(0,V.ro)(e.query.query,""),r=(0,R.aI)(n);r.setTagValues("event.type",["transaction"]).setTagValues("transaction.op",["pageload"]).setTagValues("transaction",[t]),Object.keys(r.tagValues).forEach((function(e){(0,D.h1)(e)&&r.removeTag(e)}));var o=T.PE.reduce((function(e,t){return e.concat(t.vitals)}),[]);return k.ZP.fromNewQueryWithLocation({id:void 0,version:2,name:t,fields:[].concat(a()(o.map((function(e){return"percentile(".concat(e,", ").concat(T.GW,")")}))),a()(o.map((function(e){return"count_at_least(".concat(e,", 0)")}))),a()(o.map((function(e){return"count_at_least(".concat(e,", ").concat(C.r[e].poorThreshold,")")})))),query:(0,R.gZ)(r),projects:[]},e)}}const Le=(0,_.Z)((0,q.Z)((0,z.Z)(Be)))},"./app/views/performance/transactionVitals/utils.tsx":(e,t,n)=>{"use strict";n.d(t,{Pl:()=>a,oZ:()=>o,eH:()=>i,L0:()=>s,jb:()=>l});var r=n("./app/utils/performance/histogram/utils.tsx");function a(e){var t,n=e.orgSlug,r=e.transaction,a=e.projectID,o=e.query;return{pathname:(t={orgSlug:n},"/organizations/".concat(t.orgSlug,"/performance/summary/vitals/")),query:{transaction:r,project:a,environment:o.environment,statsPeriod:o.statsPeriod,start:o.start,end:o.end,query:o.query}}}function o(e,t){var n=(0,r.te)(e);return!e.length||t>=e[e.length-1].bin+n?null:t<e[0].bin?-1:Math.floor((t-e[0].bin)/n)}function i(e){if(e.length<2)return null;for(var t=0;t<e.length;t++)for(var n=e[t],r=t+1;r<e.length;r++){var a=e[r];if(n.bin!==a.bin&&n.count!==a.count)return{point1:{x:t,y:Math.min(n.count,a.count)},point2:{x:r,y:Math.max(n.count,a.count)}}}return{point1:{x:0,y:0},point2:{x:1,y:1}}}function s(e,t){var n=e.convertToPixel({xAxisIndex:0,yAxisIndex:0},[t.point1.x,t.point1.y]);if(isNaN(null==n?void 0:n[0])||isNaN(null==n?void 0:n[1]))return null;var r=e.convertToPixel({xAxisIndex:0,yAxisIndex:0},[t.point2.x,t.point2.y]);return isNaN(null==r?void 0:r[0])||isNaN(null==r?void 0:r[1])?null:{point1:{x:n[0],y:n[1]},point2:{x:r[0],y:r[1]}}}function l(e,t,n){if(t.point1.x===t.point2.x||t.point1.y===t.point2.y||n.point1.x===n.point2.x||n.point1.y===n.point2.y)return null;var r=(e.x-t.point1.x)/(t.point2.x-t.point1.x),a=(e.y-t.point1.y)/(t.point2.y-t.point1.y);return{x:n.point1.x+(n.point2.x-n.point1.x)*r,y:n.point1.y+(n.point2.y-n.point1.y)*a}}},"../../../../node_modules/lodash/throttle.js":(e,t,n)=>{var r=n("../../../../node_modules/lodash/debounce.js"),a=n("../../../../node_modules/lodash/isObject.js");e.exports=function(e,t,n){var o=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return a(n)&&(o="leading"in n?!!n.leading:o,i="trailing"in n?!!n.trailing:i),r(e,t,{leading:o,maxWait:t,trailing:i})}}}]);
//# sourceMappingURL=PerformanceTransactionVitals.js.map