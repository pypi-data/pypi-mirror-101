(self.webpackChunkpaperAdmin=self.webpackChunkpaperAdmin||[]).push([[10],{4105:function(t,e,o){"use strict";o.r(e);var n=o(2948),s=o(2209),i=o(5716),r=o(9127),l=o(878);function a(t){this.element=t}function d(t,e){if(this.opts=Object.assign({prefix:"form",addButtonSelector:".add-row",deleteButtonSelector:".delete-row",formCssClass:"inline-related",emptyCssClass:"empty-form",animationSpeed:300},e),this.root=t,this.root._inline_formset=this,this.mgmt=new a(t),this.addButton=this.root.querySelector(this.opts.addButtonSelector),!this.addButton)throw new Error("addButton not found");this.toggleAddButtonVisibility(),this.toggleDeleteButtonVisibility(),this.addButton.querySelector("a, button").addEventListener("click",function(t){t.preventDefault(),this.addRow()}.bind(this));const o=this;this.root.addEventListener("click",(function(t){const e=t.target;if(e.closest(o.opts.deleteButtonSelector)){t.preventDefault();const n=e.closest("."+o.opts.formCssClass);o.deleteRow(n)}}))}function c(t,e,o){const n=new RegExp("("+e+"-(\\d+|__prefix__))"),s=e+"-"+o;t.querySelectorAll("*").forEach((function(t){t.htmlFor&&(t.htmlFor=t.htmlFor.replace(n,s)),t.id&&(t.id=t.id.replace(n,s)),t.name&&(t.name=t.name.replace(n,s))})),t.setAttribute("id",e+"-"+o)}function u(t,e){const o=t.querySelector(".inline-label");o&&(o.innerHTML=o.innerHTML.replace(/(#\d+)/g,"#"+e))}i.p8.registerPlugin(r.L),a.prototype.__property=function(t){return function(e){const o=this.element.querySelector(t);if(void 0===e)return parseInt(o.value.toString());e=parseInt(e),isNaN(e)||(o.value=e)}},a.prototype.totalForms=a.prototype.__property('input[name$="-TOTAL_FORMS"]'),a.prototype.minForms=a.prototype.__property('input[name$="-MIN_NUM_FORMS"]'),a.prototype.maxForms=a.prototype.__property('input[name$="-MAX_NUM_FORMS"]'),d.prototype.toggleDeleteButtonVisibility=function(){const t=this.root.querySelectorAll(this.opts.deleteButtonSelector);this.mgmt.totalForms()>this.mgmt.minForms()?t.forEach((function(t){t.hidden=!1})):t.forEach((function(t){t.hidden=!0}))},d.prototype.toggleAddButtonVisibility=function(){this.addButton.hidden=this.mgmt.totalForms()>=this.mgmt.maxForms()},d.prototype.toggleButtonState=function(t){this.addButton.disabled=!t,this.addButton.classList.toggle("disabled",!t),this.root.querySelectorAll(this.opts.deleteButtonSelector).forEach((function(e){e.disabled=!t,e.classList.toggle("disabled",!t)}))},d.prototype.getRows=function(){return this.root.querySelectorAll("."+this.opts.formCssClass+":not(."+this.opts.emptyCssClass+")")},d.prototype.updateFormIndexes=function(){const t=this.opts.prefix;this.getRows().forEach((function(e,o){c(e,t,o),u(e,o+1)}))},d.prototype.addRow=function(){if(this.mgmt.totalForms()>=this.mgmt.maxForms())return null;const t=this.root.querySelector("."+this.opts.emptyCssClass);if(!t)throw new Error("template form not found");const e=t.cloneNode(!0),o=window.pageYOffset||document.documentElement.scrollTop;e.classList.remove(this.opts.emptyCssClass),t.parentNode.insertBefore(e,t);const n=this.mgmt.totalForms();c(e,this.opts.prefix,n),u(e,n+1),s.Z.inlines.trigger("add",[e,this.opts.prefix]),this.toggleButtonState(!1);const r=function(){let t=this.mgmt.totalForms();this.mgmt.totalForms(++t),this.toggleButtonState(!0),this.toggleAddButtonVisibility(),this.toggleDeleteButtonVisibility(),this.updateFormIndexes(),this.onRowAdded(e)}.bind(this);return window.scrollTo({top:o}),"TR"!==e.tagName?i.p8.from(e,{duration:this.opts.animationSpeed/1e3,height:0,clearProps:"all",onComplete:r}):r(),e},d.prototype.onRowAdded=function(t){s.Z.dom.trigger("mutate",[t]),s.Z.inlines.trigger("added",[t,this.opts.prefix]),l(document).trigger("formset:added",[l(t),this.opts.prefix])},d.prototype.deleteRow=function(t){if(this.mgmt.totalForms()<=this.mgmt.minForms())return null;s.Z.dom.trigger("release",[t]),s.Z.inlines.trigger("remove",[t,this.opts.prefix]),this.toggleButtonState(!1);const e=function(){t.parentNode.removeChild(t);let e=this.mgmt.totalForms();this.mgmt.totalForms(--e),this.toggleButtonState(!0),this.toggleAddButtonVisibility(),this.toggleDeleteButtonVisibility(),this.updateFormIndexes(),this.onRowRemoved(t)}.bind(this);"TR"!==t.tagName?i.p8.to(t,{duration:this.opts.animationSpeed/1e3,height:0,onComplete:e}):e()},d.prototype.onRowRemoved=function(t){s.Z.inlines.trigger("removed",[t,this.opts.prefix]),l(document).trigger("formset:removed",[l(t),this.opts.prefix])};var p=d,m=o(4827),h=o(5317);function f(t,e){this.opts=Object.assign({speed:1,items:".item",moveUpBtn:".move-up",moveDownBtn:".move-down",disabledClass:"disabled",scrollWindow:!0,scrollMargin:{top:300,bottom:350},ignore:null,onChange:null},e),this.root=t,t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("update:sortbuttons",this.updateBounds.bind(this)),this.updateBounds()}i.p8.registerPlugin(r.L),f.prototype._onClick=function(t){const e=t.target,o=e.closest(this.opts.moveUpBtn);if(o&&this.root.contains(o)){if(o.classList.contains(this.opts.disabledClass))return;const e=o.closest(this.opts.items);return void(e&&(t.preventDefault(),t.stopPropagation(),this.moveUp(e)))}const n=e.closest(this.opts.moveDownBtn);if(n&&this.root.contains(n)){if(n.classList.contains(this.opts.disabledClass))return;const e=n.closest(this.opts.items);e&&(t.preventDefault(),t.stopPropagation(),this.moveDown(e))}},f.prototype._findNextItem=function(t){let e=t;for(;e;)if(this.opts.ignore&&e.matches(this.opts.ignore))e=e.nextElementSibling;else{if(e.matches(this.opts.items))break;e=e.nextElementSibling}return e},f.prototype._findPreviousItem=function(t){let e=t;for(;e;)if(this.opts.ignore&&e.matches(this.opts.ignore))e=e.previousElementSibling;else{if(e.matches(this.opts.items))break;e=e.previousElementSibling}return e},f.prototype.getItems=function(){return this.root.querySelectorAll(this.opts.items+(this.opts.ignore?":not("+this.opts.ignore+")":""))},f.prototype.moveDown=function(t){const e=this._findNextItem(t.nextElementSibling);e&&this._swap(t,e)},f.prototype.moveUp=function(t){const e=this._findPreviousItem(t.previousElementSibling);e&&this._swap(e,t,!0)},f.prototype._swap=function(t,e,o=!1){const n=t.getBoundingClientRect(),s=e.getBoundingClientRect(),i=t.style.cssText,r=e.style.cssText;this.disableItemButtons(t),this.disableItemButtons(e),e.after(t);const l=s.top-n.top-n.height;t.style.transform=`translate3d(0, ${-s.height-l}px, ${o?0:1}px)`,e.style.transform=`translate3d(0, ${s.top-n.top}px, ${o?1:0}px)`;const a=new h.Vq({onComplete:function(){t.style.cssText=i,e.style.cssText=r,this.updateBounds()}.bind(this)}).to(t,{duration:this.opts.speed,y:0,clearProps:"all"}).to(e,{duration:this.opts.speed,y:0,clearProps:"all"},0);if(this.opts.scrollWindow){const t=(window.pageYOffset||document.documentElement.scrollTop)+(o?n.top-s.top:s.top-n.top),e=this.opts.scrollMargin.top,i=window.innerHeight-this.opts.scrollMargin.bottom;let r=!0;r&=o?!(n.top>i&&s.top>i):!(n.top<e&&s.top<e),r&&a.to(window,{duration:this.opts.speed,scrollTo:{y:Math.max(0,t)}},0)}"function"==typeof this.opts.onChange&&this.opts.onChange.call(this,t,e)},f.prototype.disableItemButtons=function(t){const e=t.querySelector(this.opts.moveUpBtn),o=t.querySelector(this.opts.moveDownBtn);e.classList.add(this.opts.disabledClass),o.classList.add(this.opts.disabledClass)},f.prototype.updateBounds=function(){const t=this.root.querySelectorAll(this.opts.items);if(!t.length)return;t.forEach(function(t){const e=t.querySelector(this.opts.moveUpBtn),o=t.querySelector(this.opts.moveDownBtn);e.classList.remove(this.opts.disabledClass),o.classList.remove(this.opts.disabledClass)}.bind(this));const e=this._findNextItem(t[0]);if(e){const t=e.querySelector(this.opts.moveUpBtn);t&&t.classList.add(this.opts.disabledClass)}const o=this._findPreviousItem(t[t.length-1]);if(o){const t=o.querySelector(this.opts.moveDownBtn);t&&t.classList.add(this.opts.disabledClass)}};var g=f;function w(t,e){p.call(this,t,e),this.sortButtons=new g(t,{speed:"tabular"===t.dataset.inlineType?.25:.5,items:".sortable-item",moveUpBtn:".sortable-move-up",moveDownBtn:".sortable-move-down",ignore:".empty-form"});const o=this;s.Z.inlines.on("added",(function(){o.sortButtons.updateBounds()})),s.Z.inlines.on("removed",(function(){o.sortButtons.updateBounds()})),document.addEventListener("submit",(function(){o.updateFormIndexes();let t=0;o.sortButtons.getItems().forEach((function(e){if(e.classList.contains("has_original")||m.Z.containsChangedField(e)){const o=e.querySelector(".sortable-input");o&&(o.value=t++)}}))}))}w.prototype=Object.create(p.prototype),w.prototype.toggleButtonState=function(t){p.prototype.toggleButtonState.apply(this,arguments),this.root.querySelectorAll(this.sortButtons.opts.moveUpBtn).forEach((function(e){e.disabled=!t,e.classList.toggle("disabled",!t)})),this.root.querySelectorAll(this.sortButtons.opts.moveDownBtn).forEach((function(e){e.disabled=!t,e.classList.toggle("disabled",!t)}))};var v=w,y=(o(8103),o(878));i.p8.registerPlugin(r.L);const b=document.querySelectorAll(".invalid, .formset-errors, .formset-form-errors"),_=Array.from(b).find((function(t){return""!==t.innerHTML}));if(_){const t=_.getBoundingClientRect().top;t>50&&t<document.documentElement.clientHeight-50||setTimeout((function(){i.p8.to(window,{duration:.5,scrollTo:{y:t-Math.floor(document.documentElement.clientHeight/2),offsetY:-25}})}))}else{const t=location.hash.substr(1).replace(/-panel$/i,"-tab"),e=t&&document.querySelector(`#${t}`);e&&y(e).tab("show")}y(document).on("shown.bs.tab",(function(t){const e=t.target.getAttribute("aria-controls");if(e){history.replaceState(null,"",`#${e}`);const t=document.getElementById("changeform");if(t){const o=new URL(t.action);o.hash=e,t.action=o.toString()}}}));var S=o(9367),B=o.n(S),E=o(5932),x=o(878);class L extends E.Z{_init(t){t.closest(".empty-form")||B()(t)}_destroy(t){x(t).multiSelect("destroy")}}x(document).on("shown.bs.tab",(function(t){const e=t.target.getAttribute("href"),o=e&&document.querySelector(e);o&&B().update(o.querySelectorAll("textarea[autosize]"))}));const C=new L;C.observe("textarea[autosize]"),C.initAll("textarea[autosize]");o(9514);var k=o(8527);class A extends E.Z{constructor(t){super(),this.opts=Object.assign({},t)}_init(t){t.closest(".empty-form")||(0,k.Z)(t,this.opts)}_destroy(t){t._flatpickr&&t._flatpickr.destroy()}}document.addEventListener("wheel",(function(t){const e=t.target.closest(".numInputWrapper"),o=e&&e.querySelector("input");if(o){t.preventDefault();const e=new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,keyCode:t.deltaY>0?40:38});o.dispatchEvent(e)}}),{passive:!1}),document.addEventListener("click",(function(t){const e=t.target.closest(".vDateFieldTrigger"),o=e&&e.closest(".input-group"),n=o&&o.querySelector(".vDateInput");n&&n._flatpickr&&setTimeout((function(){n._flatpickr.open()}),0)}));const F=new A({altInput:!0,altFormat:"F j, Y",dateFormat:"Y-m-d"});F.observe(".vDatePicker"),F.initAll(".vDatePicker");const I=new A({allowInput:!0,enableTime:!0,noCalendar:!0,dateFormat:"H:i",time_24hr:!0});I.observe(".vTimePicker"),I.initAll(".vTimePicker");o(2050),o(1990);var P=o(878);class q extends E.Z{_init(t){t.closest(".empty-form")||P(t).multiSelect()}_destroy(t){P(t).multiSelect("destroy")}}const R=new q;R.observe(".vMultiSelect"),R.initAll(".vMultiSelect");o(712),o(6152);const T=document.getElementById("changeform");T&&(0,n.Z)(T),window.django_prepopulated_fields&&window.django_prepopulated_fields.length&&Promise.all([o.e(821),o.e(231)]).then(o.bind(o,7556)),document.querySelectorAll(".sortable-inline-group").forEach((function(t){new v(t,{prefix:t.dataset.inlinePrefix})})),document.querySelectorAll(".inline-group:not(.sortable-inline-group)").forEach((function(t){new p(t,{prefix:t.dataset.inlinePrefix})}))},8103:function(t,e,o){!function(t){"use strict";function e(t){return t=(t=t.replace(/\./g,"__dot__")).replace(/-/g,"__dash__")}function o(t){return t=(t=t.replace(/__dot__/g,".")).replace(/__dash__/g,"-")}function n(t,o,n){let s=t.id.replace(o,"");s=e(s);let i=t.href;n&&(-1===i.indexOf("?")?i+="?_popup=1":i+="&_popup=1");const r=void 0!==window.screenX?window.screenX:window.screenLeft,l=void 0!==window.screenY?window.screenY:window.screenTop,a=void 0!==window.outerWidth?window.outerWidth:document.body.clientWidth,d=void 0!==window.outerHeight?window.outerHeight:document.body.clientHeight,c=l+Math.round((d-600)/2),u=r+Math.round((a-940)/2);return window.open(i,s,"width=940,height=600,top="+c+",left="+u+",resizable=yes,scrollbars=yes").focus(),!1}function s(t){return n(t,/^lookup_/,!0)}function i(t){return n(t,/^(change|add|delete)_/,!1)}function r(e){const o=t(e),n=o.closest(".related-widget-wrapper").find(".view-related, .change-related, .delete-related");if(!n.length)return;const s=o.val();s?n.each((function(){const e=t(this);e.attr("href",e.attr("data-href-template").replace("__fk__",s))})):n.removeAttr("href")}function l(e,n,s){const i=o(e.name),r=document.getElementById(i);if(r){const e=r.nodeName.toUpperCase();"SELECT"===e?r.options[r.options.length]=new Option(s,n,!0,!0):"INPUT"===e&&(-1!==r.className.indexOf("vManyToManyRawIdAdminField")&&r.value?r.value+=","+n:r.value=n),t(r).trigger("change")}e.close()}window.id_to_windowname=e,window.windowname_to_id=o,window.showRelatedObjectLookupPopup=s,window.dismissRelatedLookupPopup=function(t,e){const n=o(t.name),s=document.getElementById(n);-1!==s.className.indexOf("vManyToManyRawIdAdminField")&&s.value?s.value+=","+e:document.getElementById(n).value=e,t.close()},window.showRelatedObjectPopup=i,window.updateRelatedObjectLinks=r,window.dismissAddRelatedObjectPopup=l,window.dismissChangeRelatedObjectPopup=function(e,n,s,i){const r=o(e.name).replace(/^edit_/,"");t("#"+r).find("option").each((function(){this.value===n&&(this.textContent=s,this.value=i)})),e.close()},window.dismissDeleteRelatedObjectPopup=function(e,n){const s=o(e.name).replace(/^delete_/,"");t("#"+s).find("option").each((function(){this.value===n&&t(this).remove()})).trigger("change"),e.close()},window.showAddAnotherPopup=i,window.dismissAddAnotherPopup=l,t(document).ready((function(){t("a[data-popup-opener]").on("click",(function(e){e.preventDefault(),opener.dismissRelatedLookupPopup(window,t(this).data("popup-opener"))})),t("body").on("click",".related-widget-wrapper-link",(function(e){if(e.preventDefault(),this.href){const e=t.Event("django:show-related",{href:this.href});t(this).trigger(e),e.isDefaultPrevented()||i(this)}})).on("change",".related-widget-wrapper select",(function(){const e=t.Event("django:update-related");t(this).trigger(e),e.isDefaultPrevented()||r(this)})).on("change",".related-widget-wrapper input",(function(){this.checked&&r(this)})).on("click",".related-lookup",(function(e){e.preventDefault();const o=t.Event("django:lookup-related");t(this).trigger(o),o.isDefaultPrevented()||s(this)})),t(".related-widget-wrapper select").trigger("change"),t(".related-widget-wrapper input:checked").trigger("change")}))}(o(878))},2948:function(t,e,o){"use strict";function n(t){let e=!1,o=!1;t.addEventListener("submit",(function(){e=!0}));const n=gettext("You have unsaved changes");function s(){document.removeEventListener("keydown",s),document.removeEventListener("mousedown",s),t.addEventListener("change",(function e(n){t.removeEventListener("change",e);const s=n.target,i=s.closest(".form-widget");!(null!==s.closest('[data-hook-unload="prevent"]'))&&i&&t.contains(i)&&(o=!0)}))}window.addEventListener("beforeunload",(function(t){if(!e&&o)return t.returnValue=n,n})),document.addEventListener("keydown",s),document.addEventListener("mousedown",s)}o.d(e,{Z:function(){return n}})},9514:function(){document.addEventListener("change",(function(t){const e=t.target;if("INPUT"===e.tagName&&e.closest(".vClearableFileField")){let t=e.value.split("\\").pop(),o=e.nextElementSibling.querySelector("span");o&&(o.textContent=t||o.dataset.initialText)}})),document.addEventListener("focus",(function(t){const e=t.target;"INPUT"===e.tagName&&e.closest(".vClearableFileField")&&e.classList.add("focused")})),document.addEventListener("blur",(function(t){const e=t.target;"INPUT"===e.tagName&&e.closest(".vClearableFileField")&&e.classList.remove("focused")}))},2050:function(){document.addEventListener("input",(function(t){const e=t.target.closest(".vEmailInput"),o=e&&e.closest(".input-group"),n=o&&o.querySelector(".input-group-text");if(n){e.value.trim()?n.href="mailto:"+e.value:n.removeAttribute("href")}}))},712:function(){document.addEventListener("click",(function(t){const e=t.target.closest(".vPasswordTrigger");if(e){const t=e.closest(".input-group"),o=t&&t.querySelector("i.fa"),n=t&&t.querySelector("input");if(n){const t=["fa-eye-slash","fa-eye"],e=["text","password"],s=(e.indexOf(n.type)+1)%2;n.type=e[s],o.classList.add(t[s]),o.classList.remove(t[(s+1)%2])}}}))},6152:function(){document.addEventListener("input",(function(t){const e=t.target.closest(".vURLInput"),o=e&&e.closest(".input-group"),n=o&&o.querySelector(".input-group-text");if(n){let t=e.value.trim();t?n.href=t:n.removeAttribute("href")}}))}}]);
//# sourceMappingURL=changeform.min.js.map