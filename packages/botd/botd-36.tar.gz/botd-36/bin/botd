#!/usr/bin/env python3 
# This file is placed in the Public Domain.

__version__ = 36

from botd.tbl import tbl
from botl.clt import CLI
from botl.trm import exec
from botl.zzz import os, time

def main():
    if "INVOCATION_ID" not in os.environ:
        print("run this program under systemd.")
        return
    k = CLI()
    k.tbl(tbl)
    k.cfg.mods = "rss,irc"
    k.cfg.name = "botd"
    k.cfg.version = __version__
    k.cfg.wd = "/var/lib/botd/"
    k.parse()
    if k.cfg.txt:
        k.run(k.cfg.old.txt)
        return
    k.scan("/var/lib/botd/mod/")
    k.run()
    k.start()
    k.init(k.cfg.mods)
    k.wait()

exec(main)
